      SUBROUTINE FETCH(ZLIST,FILE,RECNUM,IWRDNDX,NWORDS)
      IMPLICIT INTEGER (A-Z)
      DIMENSION ZLIST(1)
      COMMON // ICORE(1)
      COMMON /CACHE/ CACHNUM,CACHNMP1,CACHDIR(100),CACHPOS(100),
     &               CACHFILE(100),CACHMOD(100),OLDEST
      COMMON /MACHSP/ IINTLN,IFLTLN,IINTFP,IALONE,IBITWD
      COMMON /MACHSP2/MASK1,MASK2 ,ISHFSZ
      COMMON /FILSPC/ ILNBUF,IPRCLN,IPRCWD
      COMMON /IOPOS/ ICRSIZ,ICHCSZ,IOFF(2),LENREC
      IPACK(I,J)=IOR(J,ISHFT(I-49,ISHFSZ))
      UPACKR(I) =IAND(I,MASK1)
      UPACKF(I) =IAND(ISHFT(I,-ISHFSZ),MASK2)+49

      IF ((IWRDNDX.lt.1).OR.(NWORDS.lt.1)) return
      iTmp=IPACK(FILE,RECNUM)
      ILOC=IIEQ(CACHNUM,CACHDIR,1,iTmp)
      IF(ILOC.NE.0)THEN
       IADR=CACHPOS(ILOC)
       IPOS=IADR+IWRDNDX-1
       CALL ICOPY(NWORDS,ICORE(IPOS),1,ZLIST,1)
       RETURN
      ELSE
c      IF (NWORDS .EQ. LENREC) THEN
c        CALL ACES_IO_READ(FILE,RECNUM,ZLIST,LENREC)
c      ELSE
       IF(CACHMOD(OLDEST).NE.0)THEN
        IADR=CACHPOS(OLDEST)
        FILEOUT=UPACKF(CACHDIR(OLDEST))
        RECOUT =UPACKR(CACHDIR(OLDEST)) 
        CALL ACES_IO_WRITE(FILEOUT,RECOUT,ICORE(CACHPOS(OLDEST)),LENREC)
        CACHMOD(OLDEST)=0
       ENDIF
       CALL ACES_IO_READ(FILE,RECNUM,ICORE(CACHPOS(OLDEST)),LENREC)
       CACHFILE(OLDEST)=FILE
       CACHDIR (OLDEST)=IPACK(FILE,RECNUM)
       IPOS=CACHPOS(OLDEST)+IWRDNDX-1
       CALL ICOPY(NWORDS,ICORE(IPOS),1,ZLIST,1)
       RETURN
      ENDIF
c      ENDIF
      END
