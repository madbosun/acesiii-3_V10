#  Copyright (c) 2003-2010 University of Florida
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  The GNU General Public License is included in this distribution
#  in the file COPYRIGHT.
                           SIAL CCSD_RHF_SV1
#
#-------------------------------------------------------------------------------
#
# Declare indeces
# ---------------
#
      index N1       = 1, 1 # cc_iter
      index NT       = 1, 10000 
      index i7       = 1, 7 
      index ii       = 1, naocc
      index jj       = 1, naocc
      index kk       = 1, naocc
      index kiter    = 1, 1
      index kptr1    = 1, 2
#
      aoindex mu     = 1, norb
      aoindex nu     = 1, norb
      aoindex lambda = 1, norb
      aoindex sigma  = 1, norb
#
      moaindex i= baocc, eaocc
      moaindex j= baocc, eaocc
      moaindex k= baocc, eaocc
      moaindex i1= baocc, eaocc
      moaindex j1= baocc, eaocc
      moaindex k1= baocc, eaocc

      moaindex i2= baocc, eaocc
      moaindex i3= baocc, eaocc
#
      moaindex a = bavirt, eavirt
      moaindex a1= bavirt, eavirt
      moaindex a2= bavirt, eavirt
      moaindex a3= bavirt, eavirt
#
      moaindex j2= baocc, eaocc
      moaindex j3= baocc, eaocc
#
      moaindex k2= baocc, eaocc
      moaindex k3= baocc, eaocc
#
      moaindex b = bavirt, eavirt
      moaindex b1= bavirt, eavirt
      moaindex b2= bavirt, eavirt
      moaindex b3= bavirt, eavirt
#
      mobindex jj1= bbocc, ebocc  
      mobindex jj2= bbocc, ebocc  
      mobindex bb = bbvirt, ebvirt 
      mobindex bb1= bbvirt, ebvirt 
#
      moaindex p = baocc, eavirt
      moaindex p1= baocc, eavirt
      moaindex p2= baocc, eavirt
      moaindex p3= baocc, eavirt
#
      moaindex q = baocc, eavirt
      moaindex q1= baocc, eavirt
      moaindex q2= baocc, eavirt
      moaindex q3= baocc, eavirt

      mobindex qq= bbocc, ebvirt
      mobindex qq1= bbocc, ebvirt

      index kroot    = 1, 12
      index indstate = 1, 12
      index kindex12 = 1, 12
      index indone   = 1, 1
#
# Declare EOM specific arrays
#
      scalar ecorrT
      scalar R0
      SCALAR  iroot
      SCALAR  rootcount
      SCALAR  ZERO
      SCALAR  OMEGA
      SCALAR  OMEGA2
      SCALAR  L_OMEGA
      SCALAR  root_thresh
      SCALAR RNORM
      SCALAR LNORM
      SCALAR LRNORM
      scalar etemp1
      scalar etemp2
      scalar etemp3
      scalar etemp4
      scalar etemp5
      scalar sum1
      scalar sum2
      scalar sum3
      scalar sum4
      scalar sum5
      scalar onehalf 

      STATIC  ST_ROOTS (kroot,indone)
      STATIC  ST_ECORR (kroot,indone)
      TEMP         TEE (kroot,indone)
      TEMP         T1EE (kroot,indone)
      TEMP  tt1ia   (i1,a1)
      TEMP  tt1ai   (a1,i1)
      TEMP  tt2ai   (a1,i1)
      TEMP  tt1jb   (jj1,bb)
      TEMP  tt1bj   (bb,jj1)
      TEMP  tt2bj   (bb,jj1)

      TEMP  ttiajb  (i1,a1,jj1,bb)
      TEMP  tt1iaia (i1,a1,i2,a1)
      TEMP  ttjbia  (jj1,bb,i,a1)
      TEMP  tt1jbjb (jj1,bb,jj2,bb1)

      TEMP  tt1aiai (a1,i1,a2,i2)
      TEMP  tt2aiai (a1,i1,a2,i2)
      TEMP  ttaibj  (a1,i1,bb,jj1)
      TEMP  tt1aibj (a1,i1,bb,jj1)
      TEMP  tt1bjbj (bb,jj1,bb1,jj2)
      TEMP  tt2bjbj (bb,jj1,bb1,jj2)

      temp tbjbj(bb,jj1,bb1,jj2)
      temp t1bjbj(bb,jj1,bb1,jj2)
      temp tjbjb(jj1,bb,jj2,bb1)
      temp t1jbjb(jj1,bb,jj2,bb1)
      TEMP tbj(bb,jj1)
      TEMP tjb(jj1,bb)
      temp taiai(a,i,a1,i1)
      temp t1aiai(a,i,a1,i1)
      temp tiaia(i,a,i1,a1)
      temp t1iaia(i,a,i1,a1)
      TEMP tai(a,i)
      TEMP tia(i,a)

      DISTRIBUTED  REE (kindex12,indone)
      DISTRIBUTED  LEE (kindex12,indone)

      DISTRIBUTED  R1A_VECS (a1,i1,kroot)
      DISTRIBUTED  R1B_VECS (bb,jj1,kroot)
      DISTRIBUTED  L1A_VECS (i1,a1,kroot)
      DISTRIBUTED  L1B_VECS (jj1,bb,kroot)
     
      SERVED  R2AA_VECS (a1,i1,a2,i2,kroot)
      SERVED  R2AB_VECS (a1,i1,bb,jj1,kroot)
      SERVED  R2BB_VECS (bb,jj1,bb1,jj2,kroot)
      SERVED  L2AA_VECS (i1,a1,i2,a2,kroot)
      SERVED  L2AB_VECS (i1,a1,jj1,bb,kroot)
      SERVED  L2BB_VECS (jj1,bb,jj2,bb1,kroot)

      distributed HBAR_ia (i1,a)
      distributed HBAR_jb (jj1,bb)

      local  Lxjqj(mu,jj1,qq,jj2)
#
# Declare static arrays
# ---------------------
      temp  taibj(a,i,bb,jj1)
      served T2aiai(a,i,a1,j)
      served t1b_old(bb,jj1) 
      distributed l1b_old(jj1,bb1) 
      served T2aibj(a,i,bb1,jj1)  
      served TSbjbj(bb1,jj1,bb,jj2)  

      temp  tqjqj(qq,jj1,qq1,jj2)
      temp  t1qjqj(qq,jj1,qq1,jj2)
      temp  tpiqj (p,i,qq,jj1)
      temp  tpipi(p,i,p1,i1)
      temp  t1pipi(p,i,p1,i1)
      served VSpipi(p,i,p1,i1)
      served  Vpiqj(p,i,qq,jj1)
      served VSqjqj(qq,jj1,qq1,jj2)
      temp   taaai(a,a1,a2,i)
      served VSaaai(a,a1,a2,i1)
      served TSaiai(a3,i1,a1,j1) 
      served LSiaia(i2,a2,i1,a1)  
      served LSaiai(a2,i2,a1,i1)  
      served L2aibj(a2,i2,bb,jj1)
      served LSbjbj(bb,jj1,bb1,jj2)
      served L2iajb(i1,a1,jj1,bb1)  
      served LSjbjb(jj1,bb1,jj2,bb)  
      temp   taaii(a,a1,i,i1)
      temp    tiaai(i,a,a1,i1)
      served  Vaaii(a,a1,i,i1)
      served  Viaai(i,a,a1,i1)
      served t1a_old(a,i1)
      distributed l1a_old(i,a)
      served sl1a(a,i)
      served sl1b(bb,jj1)
      temp taaa(a,a1,a2) 
      temp taass(a3,a1,i,j)
      temp taa(a3,a1)
      temp tpp(p,p1)
      temp t1pp(p,p1)
      temp t2pp(p,p1)
      temp tps(p,ii) 
      temp t1ps(p,ii) 
#
      temp dpppp(p,p1,p2,p3) 
      temp tpppp(p,p1,p2,p3) 
      temp t1pppp(p,p1,p2,p3) 
      temp t2pppp(p,p1,p2,p3) 
      temp t3pppp(p,p1,p2,p3) 
      temp t4pppp(p,p1,p2,p3) 
      temp t5pppp(p,p1,p2,p3) 
      temp txpppp(p,p1,p2,p3) 
#
      local Xaaaiii(a,a1,a2,k1,ii,jj) 
      local Raaaiii(a,a1,a2,k1,ii,jj) 
     #temp Xaaaiii(a,a1,a2,k1,ii,jj) 
      temp taaaiii(a,a1,a2,k1,ii,jj) 
      distributed sai(a,i1) 
      distributed xai(a,ii) 
#
      local Lxxxj(mu,nu,lambda,jj1)
      local Lxxxi(mu,nu,lambda,i)
      local Lxxai(mu,nu,a,i)
      local Lxxbj(mu,nu,bb,jj1)
      local Lxaai(mu,a1,a,i)
      served Vxxxi(mu,nu,lambda,i)
      served Vxxxj(mu,nu,lambda,jj1)
      served Vxixi(mu,i1,lambda,i)
      served Vxixj(mu,i1,lambda,jj1)
      served Vxjxj(mu,jj2,lambda,jj1)
      served Vxxii(mu,nu,i1,i)
      served Vixxi(i1,nu,lambda,i)
      served Vxipi(mu,i,p,i1)
      served Vxiqj(mu,i,qq,jj1)
      served Vxjqj(mu,jj2,qq,jj1)
      served Vixai(i,mu,a,i1)
      served Vxaii(mu,a,i,i1)
      served Vxxai(mu,nu,a,i)
      served Vxxbj(mu,nu,bb,jj1)
      served Vxaai(mu,a1,a,i)
      temp aoint(mu,nu,lambda,sigma)
      temp Txxxi(mu,nu,lambda,i)  
      temp T1xxxi(mu,nu,lambda,i)  
      temp T1xxxj(mu,nu,lambda,jj1)  
      temp Txxxj(mu,nu,lambda,jj1)  
      temp Txixi(mu,i1,lambda,i) 
      temp Txixj(mu,i1,lambda,jj1) 
      temp Txjxj(mu,jj2,lambda,jj1) 
      temp Txxai(mu,nu,a,i) 
      temp Txxbj(mu,nu,bb,jj1)
      temp Txaai(mu,a1,a,i) 
      temp Txipi(mu,i,p,i1)   
      temp Txjqj(mu,jj1,qq,jj2)
      temp Txiqj(mu,i,qq,jj1)
      temp T1xiqj(mu,i,qq,jj1)
      temp T1xipi(mu,i,p,i1)   
      local Laaai(a2,a,a1,i)  
      temp T1aaai(a2,a,a1,i)  

      static pinf(kiter,kptr1)
      temp tpinf(kiter,kptr1)
      scalar ncount1
#
# Declare scalars
# ---------------
#
      scalar etemp
      scalar xtemp
      scalar xtemp1 
      scalar xtemp2 
      scalar xtemp3 
      scalar xtemp4 
      scalar xtemp5 
      scalar xtemp6 
      scalar xtemp7 
      scalar xtemp8 
      scalar xtemp9 
      scalar xtemp10  
      scalar xtemp11  
      scalar xtemp12  
      scalar xtemp13  
      scalar xtemp14  
      scalar xtemp15  

      scalar esum
      scalar esum_s 
      scalar eaaa
      scalar eSaaa
      scalar fact 
      scalar efact 

      scalar imin 
      scalar imax  
      scalar jmin 
      scalar jmax  
      scalar icount 
      scalar iicount 
      scalar jcount 
      scalar jjcount 
      scalar kcount 
      scalar ncount 
      scalar pcount 
      scalar fcount 
      scalar xcount 

      scalar istart 
      scalar iend  
      scalar jstart 
      scalar jend  
      scalar kstart 
      scalar kend 
      scalar whichi 
      scalar whichj 
      scalar TCOMB 
      scalar OSEG_BEG   
      scalar OSEG_END   
      scalar nsects 
      scalar scalar2 

      scalar one 
      scalar two 
      scalar three 
      scalar four  
      scalar five  
      scalar six   
      scalar seven 
      scalar eight 
      scalar nine  
      scalar ten   
      scalar eleven
      scalar twelve
      scalar thirteen 
      scalar fourteen 
      scalar fifteen 

      temp iflag(i1) 
      temp jflag(j1) 
      temp tppps(p,p1,p2,ii) 
      temp xppps(p,p1,p2,ii) 
      temp t1ppps(p,p1,p2,ii) 
      temp t2ppps(p,p1,p2,ii) 
      temp t3ppps(p,p1,p2,ii) 
      temp t4ppps(p,p1,p2,ii) 
      temp tppp(p,p1,p2) 
      temp t1ppp(p,p1,p2) 
      temp t2ppp(p,p1,p2) 
      temp t3ppp(p,p1,p2) 
      temp tpsp(p,ii,p2) 
      temp tpps(p,p2,ii) 
      temp t1pps(p,p2,ii) 
      temp t2pps(p,p2,ii) 

      static Xijk(i7) 
#
#    ------------------------------------------------------------------------
#
# --------------------------------------------------------------------------
#
     PROC READ_BLOCKDATA
#    -------------------
#
#   Read BLOCKDATA file.
      execute list_to_blocks                ree

      execute list_to_blocks                R1A_VECS
      execute list_to_blocks                R1B_VECS
      execute list_to_blocks                R2AA_VECS
      execute list_to_blocks                R2BB_VECS
      execute list_to_blocks                R2AB_VECS

      execute list_to_blocks                HBAR_ia
      execute list_to_blocks                HBAR_jb

      execute list_to_blocks                t1a_old
      execute list_to_blocks                t1b_old
      execute list_to_blocks                TSaiai
      execute list_to_blocks                T2aibj
      execute list_to_blocks                TSbjbj

      execute list_to_blocks                l1a_old
      execute list_to_blocks                l1b_old
      execute list_to_blocks                LSiaia
      execute list_to_blocks                L2iajb
      execute list_to_blocks                LSjbjb

      execute list_to_blocks                lee
      execute list_to_blocks                L1A_VECS
      execute list_to_blocks                L1B_VECS
      execute list_to_blocks                L2AA_VECS
      execute list_to_blocks                L2BB_VECS
      execute list_to_blocks                L2AB_VECS

      execute read_list_to_blocks
      execute server_barrier

      PARDO a, i, a1, i1 
            REQUEST LSiaia(i,a,i1,a1) a 
            tpipi(a,i,a1,i1) = LSiaia(i,a,i1,a1)
            PREPARE LSaiai(a,i,a1,i1) = tpipi(a,i,a1,i1)
      ENDPARDO a, i, a1, i1 

      execute server_barrier
#
      PARDO a, i
            GET l1a_old(i,a)
            tpp(a,i) = l1a_old(i,a)
            PREPARE sl1a(a,i) = tpp(a,i)
      ENDPARDO a, i
#
     ENDPROC READ_BLOCKDATA
#    ----------------------
#
#    --------------------------------------------------- ---------------------
#
#    Perform the first two stages of the transformation in two N5 steps. 
#
     PROC TRAN_TRAN2 
#
#    ------------------------------------------------------------------------
#
     PARDO mu, nu, lambda
#
          allocate Lxxxi(mu,nu,lambda,*)
#
          DO sigma
             compute_integrals aoint(mu,nu,lambda,sigma)
             DO i   
                 T1xxxi(mu,nu,lambda,i)  = aoint(mu,nu,lambda,sigma)*ca(sigma,i)
                 Lxxxi(mu,nu,lambda,i)  += T1xxxi(mu,nu,lambda,i)  
             ENDDO i   
          ENDDO sigma

          DO i
             T1xxxi(mu,nu,lambda,i)         = Lxxxi(mu,nu,lambda,i) 
             PREPARE Vxxxi(mu,nu,lambda,i)  = T1xxxi(mu,nu,lambda,i)
           DO i1
              Txixi(mu,i1,lambda,i)      = Lxxxi(mu,nu,lambda,i)*ca(nu,i1)
              PREPARE Vxixi(mu,i1,lambda,i) += Txixi(mu,i1,lambda,i)
           ENDDO i1
           ENDDO i
#
          deallocate Lxxxi(mu,nu,lambda,*)
#
     ENDPARDO mu, nu, lambda 

     PARDO mu, nu, lambda

          allocate Lxxxj(mu,nu,lambda,*)

          DO sigma
             compute_integrals aoint(mu,nu,lambda,sigma)
             DO jj1
                 T1xxxj(mu,nu,lambda,jj1)  = aoint(mu,nu,lambda,sigma)*cb(sigma,jj1)
                 Lxxxj(mu,nu,lambda,jj1)  += T1xxxj(mu,nu,lambda,jj1)
             ENDDO jj1
          ENDDO sigma

          DO jj1
             T1xxxj(mu,nu,lambda,jj1)         = Lxxxj(mu,nu,lambda,jj1)
             PREPARE Vxxxj(mu,nu,lambda,jj1)  = T1xxxj(mu,nu,lambda,jj1)
           DO i1
              Txixj(mu,i1,lambda,jj1)      = Lxxxj(mu,nu,lambda,jj1)*ca(nu,i1)
              PREPARE Vxixj(mu,i1,lambda,jj1) += Txixj(mu,i1,lambda,jj1)
           ENDDO i1
           DO jj2
              Txjxj(mu,jj2,lambda,jj1)      = Lxxxj(mu,nu,lambda,jj1)*cb(nu,jj2)
              PREPARE Vxjxj(mu,jj2,lambda,jj1) += Txjxj(mu,jj2,lambda,jj1)
           ENDDO jj2
         ENDDO jj1

         deallocate Lxxxj(mu,nu,lambda,*)

     ENDPARDO mu, nu, lambda

     execute server_barrier
#
#    ------------------------------------------------------------------------
#
     PARDO mu, nu, i
#
        ALLOCATE Lxxai(mu,nu,*,i)
#
        DO lambda
           REQUEST Vxxxi(mu,nu,lambda,i) i

           DO a
              Txxai(mu,nu,a,i) = Vxxxi(mu,nu,lambda,i)*ca(lambda,a)
              Lxxai(mu,nu,a,i) += Txxai(mu,nu,a,i)
           ENDDO a 

        ENDDO lambda
#
        DO a
           Txxai(mu,nu,a,i)         = Lxxai(mu,nu,a,i) 
           PREPARE Vxxai(mu,nu,a,i) = Txxai(mu,nu,a,i)
        ENDDO a

        DEALLOCATE Lxxai(mu,nu,*,i)
#
     ENDPARDO mu, nu, i

#
#    ------------------------------------------------------------------------
#
     execute server_barrier
     destroy Vxxxi
     destroy Vxxxj
#
#    ------------------------------------------------------------------------
#
     ENDPROC TRAN_TRAN2 
#
#    ------------------------------------------------------------------------
#
#    ------------------------------------------------------------------------
#
#    Perform the third N5 stage of the transformation.  
#
     PROC TRAN_TRAN3 
#
#    ------------------------------------------------------------------------
#
     PARDO mu, nu, i, i1
           REQUEST Vxixi(mu,i,nu,i1) i1 
           DO p 
              Txipi(mu,i,p,i1)          = Vxixi(mu,i,nu,i1)*ca(nu,p)
              PREPARE Vxipi(mu,i,p,i1) += Txipi(mu,i,p,i1)
           ENDDO p 
     ENDPARDO mu, nu, i, i1

     PARDO mu, nu, jj1, jj2
           REQUEST Vxjxj(mu,jj1,nu,jj2) jj2
           DO qq 
              Txjqj(mu,jj1,qq,jj2)          = Vxjxj(mu,jj1,nu,jj2)*cb(nu,qq)
              PREPARE Vxjqj(mu,jj1,qq,jj2) += Txjqj(mu,jj1,qq,jj2)
           ENDDO qq
     ENDPARDO mu, nu, jj1, jj2

     PARDO mu, nu, i, jj1
           REQUEST Vxixj(mu,i,nu,jj1) jj1
           DO qq
              Txiqj(mu,i,qq,jj1)          = Vxixj(mu,i,nu,jj1)*cb(nu,qq)
              PREPARE Vxiqj(mu,i,qq,jj1) += Txiqj(mu,i,qq,jj1)
           ENDDO qq
     ENDPARDO mu, nu, i, jj1


#
#    ------------------------------------------------------------------------
#
     PARDO mu, a, i
#
        ALLOCATE Lxaai(mu,*,a,i)

        DO nu
           REQUEST Vxxai(mu,nu,a,i) i 
#
           DO a1 
#
              Txaai(mu,a1,a,i)  = Vxxai(mu,nu,a,i)*ca(nu,a1)
              Lxaai(mu,a1,a,i) += Txaai(mu,a1,a,i)
#
           ENDDO a1 
        ENDDO nu
#
        DO a1
           Txaai(mu,a1,a,i)         = Lxaai(mu,a1,a,i) 
           PREPARE Vxaai(mu,a1,a,i) = Txaai(mu,a1,a,i)
        ENDDO a1

        DEALLOCATE Lxaai(mu,*,a,i)
     ENDPARDO mu, a, i
#
#    ------------------------------------------------------------------------
#
     execute server_barrier
     destroy Vxxai
#
     ENDPROC TRAN_TRAN3 
#
#    ------------------------------------------------------------------------
#
#    ------------------------------------------------------------------------
#
     PROC TRAN_TRAN4 
#
#    ------------------------------------------------------------------------
#
     PARDO mu, p, i, i1
#
           REQUEST             Vxipi(mu,i,p,i1) i1 
           REQUEST             Vxipi(mu,i1,p,i) i 
           Txipi(mu,i,p,i1)  = Vxipi(mu,i,p,i1) 
           T1xipi(mu,i,p,i1) = Vxipi(mu,i1,p,i) 
           Txipi(mu,i,p,i1) -= T1xipi(mu,i,p,i1) 
#
           DO p1 
#
              Tpipi(p1,i,p,i1)           = Txipi(mu,i,p,i1)*ca(mu,p1)
              PREPARE VSpipi(p1,i,p,i1) += Tpipi(p1,i,p,i1) 
#
           ENDDO p1 
#
     ENDPARDO mu, p, i, i1

     PARDO mu, qq, i, jj1
           REQUEST Vxiqj(mu,i,qq,jj1) jj1
           DO p1
              Tpiqj(p1,i,qq,jj1)          = Vxiqj(mu,i,qq,jj1)*ca(mu,p1)
              PREPARE Vpiqj(p1,i,qq,jj1) += Tpiqj(p1,i,qq,jj1)
           ENDDO p1
     ENDPARDO mu, qq, i, jj1

     PARDO qq, jj1, jj2

           allocate Lxjqj(*,jj1,qq,jj2)

           DO mu
              REQUEST Vxjqj(mu,jj1,qq,jj2) jj2
              REQUEST Vxjqj(mu,jj2,qq,jj1) jj2
              Lxjqj(mu,jj1,qq,jj2)  = Vxjqj(mu,jj1,qq,jj2)
              Txjqj(mu,jj1,qq,jj2)  = Vxjqj(mu,jj2,qq,jj1)
              Lxjqj(mu,jj1,qq,jj2) -= Txjqj(mu,jj1,qq,jj2)
           ENDDO mu

           DO qq1
              Tqjqj(qq1,jj1,qq,jj2) = 0.0
              DO mu
                 T1qjqj(qq1,jj1,qq,jj2)      = Lxjqj(mu,jj1,qq,jj2)*cb(mu,qq1)
                 Tqjqj(qq1,jj1,qq,jj2)      += T1qjqj(qq1,jj1,qq,jj2)
              ENDDO mu
              PREPARE VSqjqj(qq1,jj1,qq,jj2) = Tqjqj(qq1,jj1,qq,jj2)
           ENDDO qq1

           deallocate Lxjqj(*,jj1,qq,jj2)

     ENDPARDO qq, jj1, jj2

     PARDO a, a1, i
#
        ALLOCATE Laaai(*,a,a1,i)

        DO mu
           REQUEST Vxaai(mu,a,a1,i) i 
#
           DO a2  
#
              T1aaai(a2,a,a1,i)          = Vxaai(mu,a,a1,i)*ca(mu,a2)
              Laaai(a2,a,a1,i)          += T1aaai(a2,a,a1,i)
#
           ENDDO a2  
        ENDDO mu
#
        DO a2
           T1aaai(a1,a,a2,i)          = Laaai(a2,a,a1,i)
           PREPARE VSaaai(a2,a,a1,i) += Laaai(a2,a,a1,i)
           T1aaai(a1,a,a2,i)         *= -1.0
           PREPARE VSaaai(a1,a,a2,i) += T1aaai(a1,a,a2,i)
        ENDDO a2

        DEALLOCATE Laaai(*,a,a1,i) 

     ENDPARDO a, a1, i
# 
#    ------------------------------------------------------------------------
#
     ENDPROC TRAN_TRAN4 
#
#    ------------------------------------------------------------------------
#
#    ------------------------------------------------------------------------ 
#
     PROC TRAN_UHF 
# 
#        CALL COMP_INTEGRALS # --> compute integrals and put into served array 
         CALL TRAN_TRAN2     # --> performs the first two stages of the 
                             #     two-electron integral transformation.  
         CALL TRAN_TRAN3     # --> performs the third stage   
                             #     two-electron integral transformation.  
         CALL TRAN_TRAN4     # --> performs the fourth stage of the  
                             #     two-electron integral transformation.  
#
     ENDPROC TRAN_UHF 
#
#    ------------------------------------------------------------------------ 
#
# --------------------------------------------------------------------------
#
#                       t4pppp(a1,a2,k1,j1) = 0.0  
#                       t2ppps(a1,a2,k1,jj) = 0.0 
#                       t2ppp(a1,a2,k1)     = 0.0  
#                       t3ppps(a1,a2,k1,ii) = 0.0  
#                       tps(a,ii)           = 0.0  
#                       
#  ---------------------------------------------------------------------------------- 
      PROC Sai_1 
#     ---------- 
                       #t4pppp(a1,a2,k1,j1) = VSpipi(a1,j1,a2,k1) 
                       #t2ppps(a1,a2,k1,jj) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a1,a2,k1)     = t2ppps(a1,a2,k1,jj)
                        t3ppps(a1,a2,k1,ii) = t2ppp(a1,a2,k1) 
#
                        tps(a,ii)       = tpppp(a,a1,a2,k1)*t3ppps(a1,a2,k1,ii)
      ENDPROC Sai_1 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_2 
#     ---------- 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a1,a2,k1)     = t2ppps(a1,a2,k1,ii)
                        t3ppps(a1,a2,k1,jj) = t2ppp(a1,a2,k1) 
#
                        tps(a,jj)       = tpppp(a,a1,a2,k1)*t3ppps(a1,a2,k1,jj)
                        tps(a,jj)      *= -1.0  
      ENDPROC Sai_2 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_3 
#     ---------- 
                       #t4pppp(a1,a2,j1,i1) = VSpipi(a1,j1,a2,i1)
                       #t2ppps(a1,a2,j1,ii) = 0.0
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a1,a2,j1)     = t2ppps(a1,a2,j1,ii)
                        execute stripi t2ppp t2pps 
                        t2pp(a1,a2) = t2pps(a1,a2,jj)  
#
                        tpp(a,k1)       = tpppp(a,a1,a2,k1)*t2pp(a1,a2)
                        tpp(a,k1)      *= -1.0  
      ENDPROC Sai_3 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_4 
#     ---------- 
                       #t4pppp(a,a2,k1,j1) = VSpipi(a,j1,a2,k1) 
                       #t2ppps(a,a2,k1,jj) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a,a2,k1)     = t2ppps(a,a2,k1,jj)
                        t3ppps(a,a2,k1,ii) = t2ppp(a,a2,k1) 
#
                        tps(a1,ii)       = tpppp(a,a1,a2,k1)*t3ppps(a,a2,k1,ii)
                        tps(a1,ii)      *= -1.0  
      ENDPROC Sai_4 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_5 
#     ---------- 
                       #t4pppp(a,a1,k1,j1) = VSpipi(a1,j1,a,k1) 
                       #t2ppps(a,a1,k1,jj) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a,a1,k1)     = t2ppps(a,a1,k1,jj)
                        t3ppps(a,a1,k1,ii) = t2ppp(a,a1,k1) 
#
                        tps(a2,ii)       = tpppp(a,a1,a2,k1)*t3ppps(a,a1,k1,ii)
                        tps(a2,ii)      *= -1.0  
      ENDPROC Sai_5 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_6 
#     ---------- 
                       #t4pppp(a,a2,k1,i1) = VSpipi(a,i1,a2,k1) 
                       #t2ppps(a,a2,k1,ii) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a,a2,k1)     = t2ppps(a,a2,k1,ii)
                        t3ppps(a,a2,k1,jj) = t2ppp(a,a2,k1) 
#
                        tps(a1,jj)       = tpppp(a,a1,a2,k1)*t3ppps(a,a2,k1,jj)
      ENDPROC Sai_6 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_7 
#     ---------- 
                       #t4pppp(a,a2,j1,i1) = VSpipi(a,j1,a2,i1) 
                       #t2ppps(a,a2,j1,ii) = 0.0 
                       #t2pps(a,a2,jj) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a,a2,j1)     = t2ppps(a,a2,j1,ii)
                        execute stripi t2ppp t2pps 
                        t2pp(a,a2) = t2pps(a,a2,jj)  
#
                        tpp(a1,k1)       = tpppp(a,a1,a2,k1)*t2pp(a,a2)
      ENDPROC Sai_7 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_8 
#     ---------- 
                       #t4pppp(a,a1,k1,i1) = VSpipi(a1,i1,a,k1) 
                       #t2ppps(a,a1,k1,ii) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a,a1,k1)     = t2ppps(a,a1,k1,ii)
                        t3ppps(a,a1,k1,jj) = t2ppp(a,a1,k1) 
#
                        tps(a2,jj)       = tpppp(a,a1,a2,k1)*t3ppps(a,a1,k1,jj)
      ENDPROC Sai_8 
#     ------------- 
#  ---------------------------------------------------------------------------------- 

#
#  ---------------------------------------------------------------------------------- 
      PROC Sai_9 
#     ---------- 
                       #t4pppp(a,a1,j1,i1) = VSpipi(a,i1,a1,j1) 
                       #t2ppps(a,a1,j1,ii) = 0.0 
                       #t2pps(a,a1,jj) = 0.0 
                        execute stripi        t4pppp t2ppps 
#
                        t2ppp(a,a1,j1)     = t2ppps(a,a1,j1,ii)
                        execute stripi t2ppp t2pps 
                        t2pp(a,a1) = t2pps(a,a1,jj)  
#
                        tpp(a2,k1)       = tpppp(a,a1,a2,k1)*t2pp(a,a1)
      ENDPROC Sai_9 
#     ------------- 
#  ---------------------------------------------------------------------------------- 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_1 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# TERM 1 
#
# ------------------------------------------------------------------------------ 
#
            DO a3 
               kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart 
               REQUEST VSaaai(a,a3,a2,k1) a 
               jcount = 0.0 
               DO j1 
                  jcount = jcount + 1 
                  if jcount == whichj  
                     icount = 0.0 
                     DO i1 
                        icount = icount + 1 
                        if icount == whichi 

                           REQUEST  TSaiai(a3,i1,a1,j1) a3 
                           jjcount = 0.0 

                           DO jj 
                              jjcount = jjcount + 1 
                              if jjcount >= jstart  
                              if jjcount <= jend 

                                 tppps(a3,i1,a1,jj) = 0.0 
                                 execute stripi       TSaiai tppps  
                                 t1ppp(a3,i1,a1)    = tppps(a3,i1,a1,jj) 
                                 tppp(a3,a1,i1)     = t1ppp(a3,i1,a1)  
                                 iicount            = 0.0 

                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart  
                                    if iicount <= iend  

                                       tpps(a3,a1,ii)    = 0.0 
                                       execute stripi      tppp tpps  
                                       tpp(a3,a1)        = tpps(a3,a1,ii) 
                                       tpppp(a,a1,a2,k1) = VSaaai(a,a3,a2,k1)*tpp(a3,a1)  

                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1) 
                                      #Xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                    endif  
                                    endif  
                                 ENDDO ii 

                              endif  
                              endif  
                           ENDDO jj 
                        ENDIF 
                     ENDDO i1
                  ENDIF 
               ENDDO j1
               endif 
            ENDDO k1
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_1 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_2 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 2 
#
# ------------------------------------------------------------------------------ 
#
            DO a3
               kcount = 0.0 
            DO k1
               kcount = kcount + 1 
               if kcount == kstart 

                  REQUEST               VSaaai(a1,a3,a2,k1) a1
                  txpppp(a3,a1,a2,k1) = VSaaai(a1,a3,a2,k1) 
                  icount              = 0.0 

                  DO i1
                     icount = icount + 1 
                     if icount == whichi 
                        jcount = 0.0 
                     DO j1
                        jcount = jcount + 1 
                        if jcount == whichj 

                           REQUEST   TSaiai(a3,i1,a,j1)  a3
                           jjcount = 0.0

                           do jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend

                                 tppps(a3,i1,a,jj) = 0.0
                                 execute stripi      tsaiai tppps
                                 t1ppp(a3,i1,a)    = tppps(a3,i1,a,jj)
                                 tppp(a3,a,i1)     = t1ppp(a3,i1,a)
                                 tppp(a3,a,i1)    *= -1.0 # SIGN CHANGE   
                                 iicount           = 0.0

                                 do ii
                                    iicount = iicount + 1
                                    if iicount >= istart
                                    if iicount <= iend

                                       tpps(a3,a,ii)     = 0.0
                                       execute stripi      tppp tpps
                                       tpp(a3,a)         = tpps(a3,a,ii)
                                       tpppp(a,a1,a2,k1) = txpppp(a3,a1,a2,k1)*tpp(a3,a)

                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                    endif
                                    endif
                                 enddo ii

                              endif
                              endif
                           enddo jj 

                        endif 
                     ENDDO j1
                     endif 
                  ENDDO i1
               endif 
            ENDDO k1
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_2 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_3 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 3 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               kcount = 0.0 
            DO k1
               kcount = kcount + 1 
               if kcount == kstart 
                  REQUEST VSaaai(a1,a3,a,k1) a1
                  txpppp(a,a1,a3,k1) = VSaaai(a1,a3,a,k1) 
                  icount = 0.0 
                  DO i1
                     icount = icount + 1 
                     if icount == whichi 
                        jcount = 0.0 
                     DO j1
                        jcount = jcount + 1 
                        if jcount == whichj 

                           REQUEST   TSaiai(a3,i1,a2,j1) a3
                           jjcount = 0.0
                           do jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend

                                 tppps(a3,i1,a2,jj) = 0.0
                                 execute stripi       tsaiai tppps
                                 t1ppp(a3,i1,a2)    = tppps(a3,i1,a2,jj)
                                 tppp(a3,a2,i1)     = t1ppp(a3,i1,a2)

                                 iicount = 0.0
                                 do ii
                                    iicount = iicount + 1
                                    if iicount >= istart
                                    if iicount <= iend

                                       tpps(a3,a2,ii)    = 0.0
                                       execute stripi      tppp tpps
                                       tpp(a3,a2)        = tpps(a3,a2,ii)
                                       tpppp(a,a1,a2,k1) = txpppp(a,a1,a3,k1)*tpp(a3,a2)

                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                    endif
                                    endif
                                 enddo ii

                              endif
                              endif
                           enddo jj 

                        endif 
                     ENDDO j1
                     endif 
                  ENDDO i1
               endif 
            ENDDO k1
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_3 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_4 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 4 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3 
               icount = 0.0  
            DO i1 
               icount = icount + 1 
               if icount == whichi 
                  REQUEST VSaaai(a,a3,a2,i1) a 
                  kcount = 0.0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                     jcount = 0.0 
                     DO j1 
                        jcount = jcount + 1 
                        if jcount == whichj  
                           REQUEST TSaiai(a3,k1,a1,j1) a1  
                           jjcount = 0.0 
                           DO jj 
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                                 tppps(a3,k1,a1,jj)  = 0.0 
                                 execute stripi        tsaiai tppps
                                 t1ppps(a3,a1,k1,jj) = tppps(a3,k1,a1,jj)  
                                 tppp(a3,a1,k1)      = t1ppps(a3,a1,k1,jj) 
                                 tppp(a3,a1,k1)     *= -1.0  
                                 iicount = 0.0 
                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart
                                    if iicount <= iend

                                       t2ppps(a,a3,a2,ii)        = 0.0 
                                       execute stripi              VSaaai t2ppps 
                                       t2ppp(a,a3,a2)            = t2ppps(a,a3,a2,ii) 
#
                                       tpppp(a,a1,a2,k1)         = t2ppp(a,a3,a2)*tppp(a3,a1,k1)  
                                      #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                     endif 
                                     endif 
                                  ENDDO ii 
                               endif  
                               endif  
                            ENDDO jj 
#
                        endif 
                     ENDDO j1  
                     endif 
                  ENDDO k1 
               endif 
            ENDDO i1 
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_4 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_5 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 5 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3 
               icount = 0.0  
            DO i1 
               icount = icount + 1 
               if icount == whichi 
                  REQUEST               VSaaai(a1,a3,a2,i1) a1 
                  txpppp(a3,a1,a2,i1) = VSaaai(a1,a3,a2,i1) 
                  kcount = 0.0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                     jcount = 0.0 
                     DO j1 
                        jcount = jcount + 1 
                        if jcount == whichj  
#
                           REQUEST TSaiai(a3,k1,a,j1) a  
                           jjcount = 0.0 
#
                           DO jj 
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend

                                 tppps(a3,k1,a,jj) = 0.0 
                                 execute stripi      tsaiai tppps
                                 tppp(a3,k1,a)     = tppps(a3,k1,a,jj)  
                                 t1ppp(a3,a,k1)    = tppp(a3,k1,a) 
                                 iicount           = 0.0 

                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart
                                    if iicount <= iend

                                       t1ppps(a3,a1,a2,ii) = 0.0 
                                       execute stripi        txpppp t1ppps  
                                       t2ppp(a3,a1,a2)     = t1ppps(a3,a1,a2,ii) 
                                       tpppp(a,a1,a2,k1)   = t2ppp(a3,a1,a2)*t1ppp(a3,a,k1)  
#
                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                     endif 
                                     endif 
                                  ENDDO ii 
                               endif  
                               endif  
                            ENDDO jj 
#
                        endif 
                     ENDDO j1  
                     endif 
                  ENDDO k1 
               endif 
            ENDDO i1 
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_5 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_6 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 6 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3 
               icount = 0.0 
            DO i1 
               icount = icount + 1 
               if icount == whichi 
                  REQUEST              VSaaai(a1,a3,a,i1) a1 
                  txpppp(a,a1,a3,i1) = VSaaai(a1,a3,a,i1) 
                  kcount             = 0.0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                     jcount = 0.0 
                     DO j1 
                        jcount = jcount + 1 
                        if jcount == whichj 

                           REQUEST TSaiai(a3,k1,a2,j1) a2 
                           jjcount = 0.0 
#
                           DO jj 
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                                 tppps(a3,k1,a2,jj) = 0.0 
                                 execute stripi    tsaiai tppps
                                 tppp(a3,k1,a2) = tppps(a3,k1,a2,jj)  
                                 t1ppp(a3,a2,k1) = tppp(a3,k1,a2) 
                                 t1ppp(a3,a2,k1)*= -1.0  
                                 iicount = 0.0 
                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart
                                    if iicount <= iend

                                       t1ppps(a,a1,a3,ii) = 0.0 
                                       execute stripi       txpppp t1ppps 
                                       t2ppp(a,a1,a3)     = t1ppps(a,a1,a3,ii) 
                                       tpppp(a,a1,a2,k1)  = t2ppp(a,a1,a3)*t1ppp(a3,a2,k1)  
#
                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                     endif 
                                     endif 
                                  ENDDO ii 
                               endif  
                               endif  
                            ENDDO jj 
#
                        endif 
                     ENDDO j1  
                     endif 
                  ENDDO k1 
               endif 
            ENDDO i1 
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_6 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_7 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 7 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST VSaaai(a,a3,a2,j1)  a
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                     kcount = 0.0
                     DO k1
                        kcount = kcount + 1
                        if kcount == kstart
                           REQUEST              TSaiai(a3,k1,a1,i1) a3
                           tpppp(a3,a1,k1,i1) = TSaiai(a3,k1,a1,i1)
                           jjcount = 0.0
                           DO jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                              tppps(a,a3,a2,jj) = 0.0
                              execute stripi      VSaaai tppps
                              tppp(a,a3,a2)     = tppps(a,a3,a2,jj)
                              iicount = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    t1ppps(a3,a1,k1,ii)       = 0.0
                                    execute stripi               tpppp t1ppps
                                    t1ppp(a3,a1,k1)           =  t1ppps(a3,a1,k1,ii)

                                    t1pppp(a,a1,a2,k1)        = tppp(a,a3,a2)*t1ppp(a3,a1,k1)
                                   #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                   #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                    execute sum_64ss Xaaaiii t1pppp 

                                 endif
                                 endif
                              ENDDO ii
                              endif
                              endif
                           ENDDO jj
                         endif
                       ENDDO k1
                       endif
                    ENDDO i1
               endif
            ENDDO j1
            ENDDO a3
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_7 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_8 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 8 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST               VSaaai(a1,a3,a2,j1)  a1
                  t2pppp(a3,a1,a2,j1) = VSaaai(a1,a3,a2,j1)
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                     kcount = 0.0
                     DO k1
                        kcount = kcount + 1
                        if kcount == kstart
                           REQUEST             TSaiai(a3,k1,a,i1) a3
                           tpppp(a3,a,k1,i1) = TSaiai(a3,k1,a,i1)
                           jjcount = 0.0
                           DO jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                              tppps(a3,a1,a2,jj) = 0.0
                              execute stripi      t2pppp tppps
                              tppp(a3,a1,a2)    = tppps(a3,a1,a2,jj)
                              tppp(a3,a1,a2)   *= -1.0
                              iicount = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    t1ppps(a3,a,k1,ii)        = 0.0
                                    execute stripi               tpppp t1ppps
                                    t1ppp(a3,a,k1)            =  t1ppps(a3,a,k1,ii)

                                    t1pppp(a,a1,a2,k1)        = tppp(a3,a1,a2)*t1ppp(a3,a,k1)

                                   #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                   #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                    execute sum_64ss Xaaaiii t1pppp 

                                 endif
                                 endif
                              ENDDO ii
                              endif
                              endif
                           ENDDO jj
                         endif
                       ENDDO k1
                       endif
                    ENDDO i1
               endif
            ENDDO j1
            ENDDO a3
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_8 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V4O3_9 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 9 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST              VSaaai(a1,a3,a,j1)  a
                  t2pppp(a,a1,a3,j1) = VSaaai(a1,a3,a,j1)
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                     kcount = 0.0
                     DO k1
                        kcount = kcount + 1
                        if kcount == kstart
                           REQUEST              TSaiai(a3,k1,a2,i1) a3
                           tpppp(a3,a2,k1,i1) = TSaiai(a3,k1,a2,i1)
                           jjcount = 0.0
                           DO jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                              tppps(a,a1,a3,jj) = 0.0
                              execute stripi      t2pppp tppps
                              tppp(a,a1,a3)     = tppps(a,a1,a3,jj)
                              iicount = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    t1ppps(a3,a2,k1,ii)       = 0.0
                                    execute stripi               tpppp t1ppps
                                    t1ppp(a3,a2,k1)           =  t1ppps(a3,a2,k1,ii)

                                    t1pppp(a,a1,a2,k1)        = tppp(a,a1,a3)*t1ppp(a3,a2,k1)

                                   #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                   #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                    execute sum_64ss Xaaaiii t1pppp 

                                 endif
                                 endif
                              ENDDO ii
                              endif
                              endif
                           ENDDO jj
                         endif
                       ENDDO k1
                       endif
                    ENDDO i1
               endif
            ENDDO j1
            ENDDO a3
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V4O3_9 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_1 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Second do the 'cheap' part involving 3-occupied integrals and of order VVVoooo
#
# ----------------------------------------------------------------------------------------- 
#
# Term1
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               icount = 0.0
            DO i1
               icount = icount + 1
               if icount == whichi
                  REQUEST TSaiai(a,i2,a2,i1) a
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST              VSpipi(a1,k1,i2,j1) a1
                              tpppp(i2,a1,k1,j1) = VSpipi(a1,k1,i2,j1)
                              tpppp(i2,a1,k1,j1)*= -1.0
                              iicount            = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    tppps(a,i2,a2,ii) = 0.0
                                    execute stripi      TSaiai tppps
                                    tppp(a,i2,a2)     = tppps(a,i2,a2,ii)
                                    jjcount = 0.0
                                    DO jj
                                       jjcount = jjcount + 1
                                       if jjcount >= jstart
                                       if jjcount <= jend
                                          t1ppps(i2,a1,k1,jj)       = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a1,k1)           = t1ppps(i2,a1,k1,jj)

                                          t1pppp(a,a1,a2,k1)        = tppp(a,i2,a2)*t1ppp(i2,a1,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t1pppp 

                                       endif
                                       endif
                                    ENDDO jj
                                    endif
                                    endif
                                 ENDDO ii
                              endif
                         ENDDO j1
                      endif
                   ENDDO k1
               endif
            ENDDO i1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_1 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_2 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term2
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               icount = 0.0
            DO i1
               icount = icount + 1
               if icount == whichi
                  REQUEST              TSaiai(a1,i2,a2,i1) a1
                  t1pppp(i2,a1,a2,i1) = TSaiai(a1,i2,a2,i1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST             VSpipi(a,k1,i2,j1) a
                              tpppp(i2,a,k1,j1) = VSpipi(a,k1,i2,j1)
                              iicount            = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    tppps(i2,a1,a2,ii) = 0.0
                                    execute stripi       t1pppp tppps
                                    tppp(i2,a1,a2)     = tppps(i2,a1,a2,ii)
                                    jjcount = 0.0
                                    DO jj
                                       jjcount = jjcount + 1
                                       if jjcount >= jstart
                                       if jjcount <= jend
                                          t1ppps(i2,a,k1,jj)        = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a,k1)            = t1ppps(i2,a,k1,jj)

                                          t2pppp(a,a1,a2,k1)        = tppp(i2,a1,a2)*t1ppp(i2,a,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO jj
                                    endif
                                    endif
                                 ENDDO ii
                              endif
                         ENDDO j1
                      endif
                   ENDDO k1
               endif
            ENDDO i1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_2 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_3 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term3
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               icount = 0.0
            DO i1
               icount = icount + 1
               if icount == whichi
                  REQUEST             TSaiai(a1,i2,a,i1) a1
                  t1pppp(a,a1,i2,i1) = TSaiai(a1,i2,a,i1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST              VSpipi(a2,k1,i2,j1) a2
                              tpppp(i2,a2,k1,j1) = VSpipi(a2,k1,i2,j1)
                              tpppp(i2,a2,k1,j1)*= -1.0
                              iicount            = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    tppps(a,a1,i2,ii) = 0.0
                                    execute stripi      t1pppp tppps
                                    tppp(a,a1,i2)     = tppps(a,a1,i2,ii)
                                    jjcount = 0.0
                                    DO jj
                                       jjcount = jjcount + 1
                                       if jjcount >= jstart
                                       if jjcount <= jend
                                          t1ppps(i2,a2,k1,jj)       = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a2,k1)           = t1ppps(i2,a2,k1,jj)

                                          t2pppp(a,a1,a2,k1)        = tppp(a,a1,i2)*t1ppp(i2,a2,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO jj
                                    endif
                                    endif
                                 ENDDO ii
                              endif
                         ENDDO j1
                      endif
                   ENDDO k1
               endif
            ENDDO i1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_3 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_4 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term4
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST TSaiai(a,i2,a2,j1) a
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        icount = 0.0
                        DO i1
                           icount = icount + 1
                           if icount == whichi
                              REQUEST              VSpipi(a1,k1,i2,i1) a1
                              tpppp(i2,a1,k1,i1) = VSpipi(a1,k1,i2,i1)
                              jjcount            = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(a,i2,a2,jj) = 0.0
                                    execute stripi      TSaiai tppps
                                    tppp(a,i2,a2)     = tppps(a,i2,a2,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          t1ppps(i2,a1,k1,ii)       = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a1,k1)           = t1ppps(i2,a1,k1,ii)

                                          t1pppp(a,a1,a2,k1)        = tppp(a,i2,a2)*t1ppp(i2,a1,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t1pppp 

                                       endif
                                       endif
                                    ENDDO ii
                                    endif
                                    endif
                                 ENDDO jj
                              endif
                         ENDDO i1
                      endif
                   ENDDO k1
               endif
            ENDDO j1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_4 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_5 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term5
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST              TSaiai(a1,i2,a2,j1) a1
                  tpppp(i2,a1,a2,j1) = TSaiai(a1,i2,a2,j1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        icount = 0.0
                        DO i1
                           icount = icount + 1
                           if icount == whichi
                              REQUEST              VSpipi(a,k1,i2,i1) a
                              t1pppp(i2,a,k1,i1) = VSpipi(a,k1,i2,i1)
                              t1pppp(i2,a,k1,i1)*= -1.0
                              jjcount            = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a1,a2,jj) = 0.0
                                    execute stripi       tpppp tppps
                                    tppp(i2,a1,a2)     = tppps(i2,a1,a2,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          t1ppps(i2,a,k1,ii)        = 0.0
                                          execute stripi              t1pppp t1ppps
                                          t1ppp(i2,a,k1)            = t1ppps(i2,a,k1,ii)

                                          t2pppp(a,a1,a2,k1)        = tppp(i2,a1,a2)*t1ppp(i2,a,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO ii
                                    endif
                                    endif
                                 ENDDO jj
                              endif
                         ENDDO i1
                      endif
                   ENDDO k1
               endif
            ENDDO j1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_5 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_6 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term6
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST             TSaiai(a1,i2,a,j1) a
                  tpppp(a,a1,i2,j1) = TSaiai(a1,i2,a,j1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        icount = 0.0
                        DO i1
                           icount = icount + 1
                           if icount == whichi
                              REQUEST               VSpipi(a2,k1,i2,i1) a2  
                              t1pppp(i2,a2,k1,i1) = VSpipi(a2,k1,i2,i1)
                              jjcount             = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(a,a1,i2,jj) = 0.0
                                    execute stripi      tpppp tppps
                                    tppp(a,a1,i2)     = tppps(a,a1,i2,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          t1ppps(i2,a2,k1,ii)       = 0.0
                                          execute stripi              t1pppp t1ppps
                                          t1ppp(i2,a2,k1)           = t1ppps(i2,a2,k1,ii)

                                          t2pppp(a,a1,a2,k1)        = tppp(a,a1,i2)*t1ppp(i2,a2,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO ii
                                    endif
                                    endif
                                 ENDDO jj
                              endif
                         ENDDO i1
                      endif
                   ENDDO k1
               endif
            ENDDO j1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_6 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_7 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term7
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               kcount = 0.0
            DO k1
               kcount = kcount + 1
               if kcount == kstart
                  REQUEST TSaiai(a,i2,a2,k1) a
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST VSpipi(a1,i1,i2,j1) a1
                              t1pppp(i2,a1,i1,j1) = VSpipi(a1,i1,i2,j1)
                              jjcount = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a1,i1,jj) = 0.0
                                    execute stripi t1pppp tppps
                                    tppp(i2,a1,i1) = tppps(i2,a1,i1,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          tpps(i2,a1,ii) = 0.0
                                          execute stripi tppp tpps
                                          tpp(i2,a1) = tpps(i2,a1,ii)

                                          tpppp(a,a1,a2,k1) = TSaiai(a,i2,a2,k1)*tpp(i2,a1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii tpppp 

                                       endif
                                       endif
                                     ENDDO ii
                                   endif
                                   endif
                                ENDDO jj
                             endif
                          ENDDO j1
                        endif
                   ENDDO i1
                 endif 
            ENDDO k1
            ENDDO i2 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_7 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_8 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term8
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               kcount = 0.0
            DO k1
               kcount = kcount + 1
               if kcount == kstart
                  REQUEST               TSaiai(a1,i2,a2,k1) a1
                  t1pppp(i2,a1,a2,k1) = TSaiai(a1,i2,a2,k1)
                  t1pppp(i2,a1,a2,k1)*= -1.0 
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST              VSpipi(a,i1,i2,j1) a
                              t2pppp(i2,a,i1,j1) = VSpipi(a,i1,i2,j1)
                              jjcount = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a,i1,jj) = 0.0
                                    execute stripi t2pppp tppps
                                    tppp(i2,a,i1) = tppps(i2,a,i1,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          tpps(i2,a,ii) = 0.0
                                          execute stripi tppp tpps
                                          tpp(i2,a) = tpps(i2,a,ii)

                                          tpppp(a,a1,a2,k1) = t1pppp(i2,a1,a2,k1)*tpp(i2,a)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii tpppp 

                                       endif
                                       endif
                                     ENDDO ii
                                   endif
                                   endif
                                ENDDO jj
                             endif
                          ENDDO j1
                        endif
                   ENDDO i1
                 endif
            ENDDO k1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_8 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC V3O4_9 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term9
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               kcount = 0.0
            DO k1
               kcount = kcount + 1
               if kcount == kstart
                  REQUEST              TSaiai(a1,i2,a,k1) a1
                  t1pppp(a,a1,i2,k1) = TSaiai(a1,i2,a,k1)
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST               VSpipi(a2,i1,i2,j1) a2
                              t2pppp(i2,a2,i1,j1) = VSpipi(a2,i1,i2,j1)
                              jjcount = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a2,i1,jj) = 0.0
                                    execute stripi t2pppp tppps
                                    tppp(i2,a2,i1) = tppps(i2,a2,i1,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          tpps(i2,a2,ii) = 0.0
                                          execute stripi tppp tpps
                                          tpp(i2,a2) = tpps(i2,a2,ii)

                                          tpppp(a,a1,a2,k1) = t1pppp(a,a1,i2,k1)*tpp(i2,a2)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii tpppp 

                                       endif
                                       endif
                                     ENDDO ii
                                   endif
                                   endif
                                ENDDO jj
                             endif
                          ENDDO j1
                        endif
                   ENDDO i1
                 endif
            ENDDO k1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC V3O4_9 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_1 
#     ------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 1 
#
# ------------------------------------------------------------------------------ 
#
            DO a3 
               kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart 
               REQUEST VSaaai(a,a3,a2,k1) a 
               jcount = 0.0 
               DO j1 
                  jcount = jcount + 1 
                  if jcount == whichj  
                     icount = 0.0 
                     DO i1 
                        icount = icount + 1 
                        if icount == whichi 

                           REQUEST  LSaiai(a3,i1,a1,j1) a3 
                           jjcount = 0.0 

                           DO jj 
                              jjcount = jjcount + 1 
                              if jjcount >= jstart  
                              if jjcount <= jend 

                                 tppps(a3,i1,a1,jj) = 0.0 
                                 execute stripi       LSaiai tppps  
                                 t1ppp(a3,i1,a1)    = tppps(a3,i1,a1,jj) 
                                 tppp(a3,a1,i1)     = t1ppp(a3,i1,a1)  
                                 iicount            = 0.0 

                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart  
                                    if iicount <= iend  

                                       tpps(a3,a1,ii)    = 0.0 
                                       execute stripi      tppp tpps  
                                       tpp(a3,a1)        = tpps(a3,a1,ii) 
                                       tpppp(a,a1,a2,k1) = VSaaai(a,a3,a2,k1)*tpp(a3,a1)  

                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1) 
                                      #Xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                    endif  
                                    endif  
                                 ENDDO ii 

                              endif  
                              endif  
                           ENDDO jj 
                        ENDIF 
                     ENDDO i1
                  ENDIF 
               ENDDO j1
               endif 
            ENDDO k1
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_1 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_2 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 2 
#
# ------------------------------------------------------------------------------ 
#
            DO a3
               kcount = 0.0 
            DO k1
               kcount = kcount + 1 
               if kcount == kstart 

                  REQUEST               VSaaai(a1,a3,a2,k1) a1
                  txpppp(a3,a1,a2,k1) = VSaaai(a1,a3,a2,k1) 
                  icount              = 0.0 

                  DO i1
                     icount = icount + 1 
                     if icount == whichi 
                        jcount = 0.0 
                     DO j1
                        jcount = jcount + 1 
                        if jcount == whichj 

                           REQUEST   LSaiai(a3,i1,a,j1)  a3
                           jjcount = 0.0

                           do jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend

                                 tppps(a3,i1,a,jj) = 0.0
                                 execute stripi      Lsaiai tppps
                                 t1ppp(a3,i1,a)    = tppps(a3,i1,a,jj)
                                 tppp(a3,a,i1)     = t1ppp(a3,i1,a)
                                 tppp(a3,a,i1)    *= -1.0 # SIGN CHANGE   
                                 iicount           = 0.0

                                 do ii
                                    iicount = iicount + 1
                                    if iicount >= istart
                                    if iicount <= iend

                                       tpps(a3,a,ii)     = 0.0
                                       execute stripi      tppp tpps
                                       tpp(a3,a)         = tpps(a3,a,ii)
                                       tpppp(a,a1,a2,k1) = txpppp(a3,a1,a2,k1)*tpp(a3,a)

                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                    endif
                                    endif
                                 enddo ii

                              endif
                              endif
                           enddo jj 

                        endif 
                     ENDDO j1
                     endif 
                  ENDDO i1
               endif 
            ENDDO k1
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_2 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_3 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 3 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               kcount = 0.0 
            DO k1
               kcount = kcount + 1 
               if kcount == kstart 
                  REQUEST VSaaai(a1,a3,a,k1) a1
                  txpppp(a,a1,a3,k1) = VSaaai(a1,a3,a,k1) 
                  icount = 0.0 
                  DO i1
                     icount = icount + 1 
                     if icount == whichi 
                        jcount = 0.0 
                     DO j1
                        jcount = jcount + 1 
                        if jcount == whichj 

                           REQUEST   LSaiai(a3,i1,a2,j1) a3
                           jjcount = 0.0
                           do jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend

                                 tppps(a3,i1,a2,jj) = 0.0
                                 execute stripi       Lsaiai tppps
                                 t1ppp(a3,i1,a2)    = tppps(a3,i1,a2,jj)
                                 tppp(a3,a2,i1)     = t1ppp(a3,i1,a2)

                                 iicount = 0.0
                                 do ii
                                    iicount = iicount + 1
                                    if iicount >= istart
                                    if iicount <= iend

                                       tpps(a3,a2,ii)    = 0.0
                                       execute stripi      tppp tpps
                                       tpp(a3,a2)        = tpps(a3,a2,ii)
                                       tpppp(a,a1,a2,k1) = txpppp(a,a1,a3,k1)*tpp(a3,a2)

                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                    endif
                                    endif
                                 enddo ii

                              endif
                              endif
                           enddo jj 

                        endif 
                     ENDDO j1
                     endif 
                  ENDDO i1
               endif 
            ENDDO k1
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_3 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_4 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 4 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3 
               icount = 0.0  
            DO i1 
               icount = icount + 1 
               if icount == whichi 
                  REQUEST VSaaai(a,a3,a2,i1) a 
                  kcount = 0.0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                     jcount = 0.0 
                     DO j1 
                        jcount = jcount + 1 
                        if jcount == whichj  
                           REQUEST LSaiai(a3,k1,a1,j1) a1  
                           jjcount = 0.0 
                           DO jj 
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                                 tppps(a3,k1,a1,jj)  = 0.0 
                                 execute stripi        Lsaiai tppps
                                 t1ppps(a3,a1,k1,jj) = tppps(a3,k1,a1,jj)  
                                 tppp(a3,a1,k1)      = t1ppps(a3,a1,k1,jj) 
                                 tppp(a3,a1,k1)     *= -1.0  
                                 iicount = 0.0 
                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart
                                    if iicount <= iend

                                       t2ppps(a,a3,a2,ii)        = 0.0 
                                       execute stripi              VSaaai t2ppps 
                                       t2ppp(a,a3,a2)            = t2ppps(a,a3,a2,ii) 
#
                                       tpppp(a,a1,a2,k1)         = t2ppp(a,a3,a2)*tppp(a3,a1,k1)  
                                      #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                     endif 
                                     endif 
                                  ENDDO ii 
                               endif  
                               endif  
                            ENDDO jj 
#
                        endif 
                     ENDDO j1  
                     endif 
                  ENDDO k1 
               endif 
            ENDDO i1 
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_4 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_5 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 5 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3 
               icount = 0.0  
            DO i1 
               icount = icount + 1 
               if icount == whichi 
                  REQUEST               VSaaai(a1,a3,a2,i1) a1 
                  txpppp(a3,a1,a2,i1) = VSaaai(a1,a3,a2,i1) 
                  kcount = 0.0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                     jcount = 0.0 
                     DO j1 
                        jcount = jcount + 1 
                        if jcount == whichj  
#
                           REQUEST LSaiai(a3,k1,a,j1) a  
                           jjcount = 0.0 
#
                           DO jj 
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend

                                 tppps(a3,k1,a,jj) = 0.0 
                                 execute stripi      Lsaiai tppps
                                 tppp(a3,k1,a)     = tppps(a3,k1,a,jj)  
                                 t1ppp(a3,a,k1)    = tppp(a3,k1,a) 
                                 iicount           = 0.0 

                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart
                                    if iicount <= iend

                                       t1ppps(a3,a1,a2,ii) = 0.0 
                                       execute stripi        txpppp t1ppps  
                                       t2ppp(a3,a1,a2)     = t1ppps(a3,a1,a2,ii) 
                                       tpppp(a,a1,a2,k1)   = t2ppp(a3,a1,a2)*t1ppp(a3,a,k1)  
#
                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                     endif 
                                     endif 
                                  ENDDO ii 
                               endif  
                               endif  
                            ENDDO jj 
#
                        endif 
                     ENDDO j1  
                     endif 
                  ENDDO k1 
               endif 
            ENDDO i1 
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_5 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_6 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 6 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3 
               icount = 0.0 
            DO i1 
               icount = icount + 1 
               if icount == whichi 
                  REQUEST              VSaaai(a1,a3,a,i1) a1 
                  txpppp(a,a1,a3,i1) = VSaaai(a1,a3,a,i1) 
                  kcount             = 0.0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                     jcount = 0.0 
                     DO j1 
                        jcount = jcount + 1 
                        if jcount == whichj 

                           REQUEST LSaiai(a3,k1,a2,j1) a2 
                           jjcount = 0.0 
#
                           DO jj 
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                                 tppps(a3,k1,a2,jj) = 0.0 
                                 execute stripi    Lsaiai tppps
                                 tppp(a3,k1,a2) = tppps(a3,k1,a2,jj)  
                                 t1ppp(a3,a2,k1) = tppp(a3,k1,a2) 
                                 t1ppp(a3,a2,k1)*= -1.0  
                                 iicount = 0.0 
                                 DO ii 
                                    iicount = iicount + 1 
                                    if iicount >= istart
                                    if iicount <= iend

                                       t1ppps(a,a1,a3,ii) = 0.0 
                                       execute stripi       txpppp t1ppps 
                                       t2ppp(a,a1,a3)     = t1ppps(a,a1,a3,ii) 
                                       tpppp(a,a1,a2,k1)  = t2ppp(a,a1,a3)*t1ppp(a3,a2,k1)  
#
                                      #taaaiii(a,a1,a2,k1,ii,jj)  = tpppp(a,a1,a2,k1)
                                      #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                       execute sum_64ss Xaaaiii tpppp 

                                     endif 
                                     endif 
                                  ENDDO ii 
                               endif  
                               endif  
                            ENDDO jj 
#
                        endif 
                     ENDDO j1  
                     endif 
                  ENDDO k1 
               endif 
            ENDDO i1 
            ENDDO a3 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_6 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_7 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 7 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST VSaaai(a,a3,a2,j1)  a
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                     kcount = 0.0
                     DO k1
                        kcount = kcount + 1
                        if kcount == kstart
                           REQUEST              LSaiai(a3,k1,a1,i1) a3
                           tpppp(a3,a1,k1,i1) = LSaiai(a3,k1,a1,i1)
                           jjcount = 0.0
                           DO jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                              tppps(a,a3,a2,jj) = 0.0
                              execute stripi      VSaaai tppps
                              tppp(a,a3,a2)     = tppps(a,a3,a2,jj)
                              iicount = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    t1ppps(a3,a1,k1,ii)       = 0.0
                                    execute stripi               tpppp t1ppps
                                    t1ppp(a3,a1,k1)           =  t1ppps(a3,a1,k1,ii)

                                    t1pppp(a,a1,a2,k1)        = tppp(a,a3,a2)*t1ppp(a3,a1,k1)
                                   #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                   #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)
                                    execute sum_64ss Xaaaiii t1pppp 

                                 endif
                                 endif
                              ENDDO ii
                              endif
                              endif
                           ENDDO jj
                         endif
                       ENDDO k1
                       endif
                    ENDDO i1
               endif
            ENDDO j1
            ENDDO a3
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_7 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_8 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 8 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST               VSaaai(a1,a3,a2,j1)  a1
                  t2pppp(a3,a1,a2,j1) = VSaaai(a1,a3,a2,j1)
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                     kcount = 0.0
                     DO k1
                        kcount = kcount + 1
                        if kcount == kstart
                           REQUEST             LSaiai(a3,k1,a,i1) a3
                           tpppp(a3,a,k1,i1) = LSaiai(a3,k1,a,i1)
                           jjcount = 0.0
                           DO jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                              tppps(a3,a1,a2,jj) = 0.0
                              execute stripi      t2pppp tppps
                              tppp(a3,a1,a2)    = tppps(a3,a1,a2,jj)
                              tppp(a3,a1,a2)   *= -1.0
                              iicount = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    t1ppps(a3,a,k1,ii)        = 0.0
                                    execute stripi               tpppp t1ppps
                                    t1ppp(a3,a,k1)            =  t1ppps(a3,a,k1,ii)

                                    t1pppp(a,a1,a2,k1)        = tppp(a3,a1,a2)*t1ppp(a3,a,k1)

                                   #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                   #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                    execute sum_64ss Xaaaiii t1pppp 

                                 endif
                                 endif
                              ENDDO ii
                              endif
                              endif
                           ENDDO jj
                         endif
                       ENDDO k1
                       endif
                    ENDDO i1
               endif
            ENDDO j1
            ENDDO a3
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_8 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV4O3_9 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
# TERM 9 
#
# ----------------------------------------------------------------------------------------- 
#
            DO a3
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST              VSaaai(a1,a3,a,j1)  a
                  t2pppp(a,a1,a3,j1) = VSaaai(a1,a3,a,j1)
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                     kcount = 0.0
                     DO k1
                        kcount = kcount + 1
                        if kcount == kstart
                           REQUEST              LSaiai(a3,k1,a2,i1) a3
                           tpppp(a3,a2,k1,i1) = LSaiai(a3,k1,a2,i1)
                           jjcount = 0.0
                           DO jj
                              jjcount = jjcount + 1
                              if jjcount >= jstart
                              if jjcount <= jend
                              tppps(a,a1,a3,jj) = 0.0
                              execute stripi      t2pppp tppps
                              tppp(a,a1,a3)     = tppps(a,a1,a3,jj)
                              iicount = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    t1ppps(a3,a2,k1,ii)       = 0.0
                                    execute stripi               tpppp t1ppps
                                    t1ppp(a3,a2,k1)           =  t1ppps(a3,a2,k1,ii)

                                    t1pppp(a,a1,a2,k1)        = tppp(a,a1,a3)*t1ppp(a3,a2,k1)

                                   #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                   #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                    execute sum_64ss Xaaaiii t1pppp 

                                 endif
                                 endif
                              ENDDO ii
                              endif
                              endif
                           ENDDO jj
                         endif
                       ENDDO k1
                       endif
                    ENDDO i1
               endif
            ENDDO j1
            ENDDO a3
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV4O3_9 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_1 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Second do the 'cheap' part involving 3-occupied integrals and of order VVVoooo
#
# ----------------------------------------------------------------------------------------- 
#
# Term1
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               icount = 0.0
            DO i1
               icount = icount + 1
               if icount == whichi
                  REQUEST LSaiai(a,i2,a2,i1) a
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST              VSpipi(a1,k1,i2,j1) a1
                              tpppp(i2,a1,k1,j1) = VSpipi(a1,k1,i2,j1)
                              tpppp(i2,a1,k1,j1)*= -1.0
                              iicount            = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    tppps(a,i2,a2,ii) = 0.0
                                    execute stripi      LSaiai tppps
                                    tppp(a,i2,a2)     = tppps(a,i2,a2,ii)
                                    jjcount = 0.0
                                    DO jj
                                       jjcount = jjcount + 1
                                       if jjcount >= jstart
                                       if jjcount <= jend
                                          t1ppps(i2,a1,k1,jj)       = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a1,k1)           = t1ppps(i2,a1,k1,jj)

                                          t1pppp(a,a1,a2,k1)        = tppp(a,i2,a2)*t1ppp(i2,a1,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t1pppp 

                                       endif
                                       endif
                                    ENDDO jj
                                    endif
                                    endif
                                 ENDDO ii
                              endif
                         ENDDO j1
                      endif
                   ENDDO k1
               endif
            ENDDO i1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_1 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_2 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term2
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               icount = 0.0
            DO i1
               icount = icount + 1
               if icount == whichi
                  REQUEST              LSaiai(a1,i2,a2,i1) a1
                  t1pppp(i2,a1,a2,i1) = LSaiai(a1,i2,a2,i1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST             VSpipi(a,k1,i2,j1) a
                              tpppp(i2,a,k1,j1) = VSpipi(a,k1,i2,j1)
                              iicount            = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    tppps(i2,a1,a2,ii) = 0.0
                                    execute stripi       t1pppp tppps
                                    tppp(i2,a1,a2)     = tppps(i2,a1,a2,ii)
                                    jjcount = 0.0
                                    DO jj
                                       jjcount = jjcount + 1
                                       if jjcount >= jstart
                                       if jjcount <= jend
                                          t1ppps(i2,a,k1,jj)        = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a,k1)            = t1ppps(i2,a,k1,jj)

                                          t2pppp(a,a1,a2,k1)        = tppp(i2,a1,a2)*t1ppp(i2,a,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO jj
                                    endif
                                    endif
                                 ENDDO ii
                              endif
                         ENDDO j1
                      endif
                   ENDDO k1
               endif
            ENDDO i1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_2 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_3 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term3
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               icount = 0.0
            DO i1
               icount = icount + 1
               if icount == whichi
                  REQUEST             LSaiai(a1,i2,a,i1) a1
                  t1pppp(a,a1,i2,i1) = LSaiai(a1,i2,a,i1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST              VSpipi(a2,k1,i2,j1) a2
                              tpppp(i2,a2,k1,j1) = VSpipi(a2,k1,i2,j1)
                              tpppp(i2,a2,k1,j1)*= -1.0
                              iicount            = 0.0
                              DO ii
                                 iicount = iicount + 1
                                 if iicount >= istart
                                 if iicount <= iend
                                    tppps(a,a1,i2,ii) = 0.0
                                    execute stripi      t1pppp tppps
                                    tppp(a,a1,i2)     = tppps(a,a1,i2,ii)
                                    jjcount = 0.0
                                    DO jj
                                       jjcount = jjcount + 1
                                       if jjcount >= jstart
                                       if jjcount <= jend
                                          t1ppps(i2,a2,k1,jj)       = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a2,k1)           = t1ppps(i2,a2,k1,jj)

                                          t2pppp(a,a1,a2,k1)        = tppp(a,a1,i2)*t1ppp(i2,a2,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO jj
                                    endif
                                    endif
                                 ENDDO ii
                              endif
                         ENDDO j1
                      endif
                   ENDDO k1
               endif
            ENDDO i1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_3 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_4 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term4
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST LSaiai(a,i2,a2,j1) a
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        icount = 0.0
                        DO i1
                           icount = icount + 1
                           if icount == whichi
                              REQUEST              VSpipi(a1,k1,i2,i1) a1
                              tpppp(i2,a1,k1,i1) = VSpipi(a1,k1,i2,i1)
                              jjcount            = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(a,i2,a2,jj) = 0.0
                                    execute stripi      LSaiai tppps
                                    tppp(a,i2,a2)     = tppps(a,i2,a2,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          t1ppps(i2,a1,k1,ii)       = 0.0
                                          execute stripi              tpppp t1ppps
                                          t1ppp(i2,a1,k1)           = t1ppps(i2,a1,k1,ii)

                                          t1pppp(a,a1,a2,k1)        = tppp(a,i2,a2)*t1ppp(i2,a1,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t1pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t1pppp 

                                       endif
                                       endif
                                    ENDDO ii
                                    endif
                                    endif
                                 ENDDO jj
                              endif
                         ENDDO i1
                      endif
                   ENDDO k1
               endif
            ENDDO j1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_4 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_5 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term5
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST              LSaiai(a1,i2,a2,j1) a1
                  tpppp(i2,a1,a2,j1) = LSaiai(a1,i2,a2,j1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        icount = 0.0
                        DO i1
                           icount = icount + 1
                           if icount == whichi
                              REQUEST              VSpipi(a,k1,i2,i1) a
                              t1pppp(i2,a,k1,i1) = VSpipi(a,k1,i2,i1)
                              t1pppp(i2,a,k1,i1)*= -1.0
                              jjcount            = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a1,a2,jj) = 0.0
                                    execute stripi       tpppp tppps
                                    tppp(i2,a1,a2)     = tppps(i2,a1,a2,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          t1ppps(i2,a,k1,ii)        = 0.0
                                          execute stripi              t1pppp t1ppps
                                          t1ppp(i2,a,k1)            = t1ppps(i2,a,k1,ii)

                                          t2pppp(a,a1,a2,k1)        = tppp(i2,a1,a2)*t1ppp(i2,a,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO ii
                                    endif
                                    endif
                                 ENDDO jj
                              endif
                         ENDDO i1
                      endif
                   ENDDO k1
               endif
            ENDDO j1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_5 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_6 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term6
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               jcount = 0.0
            DO j1
               jcount = jcount + 1
               if jcount == whichj
                  REQUEST             LSaiai(a1,i2,a,j1) a
                  tpppp(a,a1,i2,j1) = LSaiai(a1,i2,a,j1)
                  kcount = 0.0
                  DO k1
                     kcount = kcount + 1
                     if kcount == kstart
                        icount = 0.0
                        DO i1
                           icount = icount + 1
                           if icount == whichi
                              REQUEST               VSpipi(a2,k1,i2,i1) a2  
                              t1pppp(i2,a2,k1,i1) = VSpipi(a2,k1,i2,i1)
                              jjcount             = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(a,a1,i2,jj) = 0.0
                                    execute stripi      tpppp tppps
                                    tppp(a,a1,i2)     = tppps(a,a1,i2,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          t1ppps(i2,a2,k1,ii)       = 0.0
                                          execute stripi              t1pppp t1ppps
                                          t1ppp(i2,a2,k1)           = t1ppps(i2,a2,k1,ii)

                                          t2pppp(a,a1,a2,k1)        = tppp(a,a1,i2)*t1ppp(i2,a2,k1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = t2pppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii t2pppp 

                                       endif
                                       endif
                                    ENDDO ii
                                    endif
                                    endif
                                 ENDDO jj
                              endif
                         ENDDO i1
                      endif
                   ENDDO k1
               endif
            ENDDO j1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_6 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_7 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term7
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               kcount = 0.0
            DO k1
               kcount = kcount + 1
               if kcount == kstart
                  REQUEST LSaiai(a,i2,a2,k1) a
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST VSpipi(a1,i1,i2,j1) a1
                              t1pppp(i2,a1,i1,j1) = VSpipi(a1,i1,i2,j1)
                              jjcount = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a1,i1,jj) = 0.0
                                    execute stripi t1pppp tppps
                                    tppp(i2,a1,i1) = tppps(i2,a1,i1,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          tpps(i2,a1,ii) = 0.0
                                          execute stripi tppp tpps
                                          tpp(i2,a1) = tpps(i2,a1,ii)

                                          tpppp(a,a1,a2,k1) = LSaiai(a,i2,a2,k1)*tpp(i2,a1)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii tpppp 

                                       endif
                                       endif
                                     ENDDO ii
                                   endif
                                   endif
                                ENDDO jj
                             endif
                          ENDDO j1
                        endif
                   ENDDO i1
                 endif 
            ENDDO k1
            ENDDO i2 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_7 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_8 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term8
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               kcount = 0.0
            DO k1
               kcount = kcount + 1
               if kcount == kstart
                  REQUEST               LSaiai(a1,i2,a2,k1) a1
                  t1pppp(i2,a1,a2,k1) = LSaiai(a1,i2,a2,k1)
                  t1pppp(i2,a1,a2,k1)*= -1.0 
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST              VSpipi(a,i1,i2,j1) a
                              t2pppp(i2,a,i1,j1) = VSpipi(a,i1,i2,j1)
                              jjcount = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a,i1,jj) = 0.0
                                    execute stripi t2pppp tppps
                                    tppp(i2,a,i1) = tppps(i2,a,i1,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          tpps(i2,a,ii) = 0.0
                                          execute stripi tppp tpps
                                          tpp(i2,a) = tpps(i2,a,ii)

                                          tpppp(a,a1,a2,k1) = t1pppp(i2,a1,a2,k1)*tpp(i2,a)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii tpppp 

                                       endif
                                       endif
                                     ENDDO ii
                                   endif
                                   endif
                                ENDDO jj
                             endif
                          ENDDO j1
                        endif
                   ENDDO i1
                 endif
            ENDDO k1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_8 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
      PROC LV3O4_9 
#     ----------- 
#
# ------------------------------------------------------------------------------ 
#
# ----------------------------------------------------------------------------------------- 
#
# Term9
#
# ----------------------------------------------------------------------------------------- 
#
            DO i2
               kcount = 0.0
            DO k1
               kcount = kcount + 1
               if kcount == kstart
                  REQUEST              LSaiai(a1,i2,a,k1) a1
                  t1pppp(a,a1,i2,k1) = LSaiai(a1,i2,a,k1)
                  icount = 0.0
                  DO i1
                     icount = icount + 1
                     if icount == whichi
                        jcount = 0.0
                        DO j1
                           jcount = jcount + 1
                           if jcount == whichj
                              REQUEST               VSpipi(a2,i1,i2,j1) a2
                              t2pppp(i2,a2,i1,j1) = VSpipi(a2,i1,i2,j1)
                              jjcount = 0.0
                              DO jj
                                 jjcount = jjcount + 1
                                 if jjcount >= jstart
                                 if jjcount <= jend
                                    tppps(i2,a2,i1,jj) = 0.0
                                    execute stripi t2pppp tppps
                                    tppp(i2,a2,i1) = tppps(i2,a2,i1,jj)
                                    iicount = 0.0
                                    DO ii
                                       iicount = iicount + 1
                                       if iicount >= istart
                                       if iicount <= iend
                                          tpps(i2,a2,ii) = 0.0
                                          execute stripi tppp tpps
                                          tpp(i2,a2) = tpps(i2,a2,ii)

                                          tpppp(a,a1,a2,k1) = t1pppp(a,a1,i2,k1)*tpp(i2,a2)

                                         #taaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
                                         #xaaaiii(a,a1,a2,k1,ii,jj) += taaaiii(a,a1,a2,k1,ii,jj)

                                          execute sum_64ss Xaaaiii tpppp 

                                       endif
                                       endif
                                     ENDDO ii
                                   endif
                                   endif
                                ENDDO jj
                             endif
                          ENDDO j1
                        endif
                   ENDDO i1
                 endif
            ENDDO k1
            ENDDO i2
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC LV3O4_9 
#     -------------- 
#
# ------------------------------------------------------------------------------ 
#
#
# ------------------------------------------------------------------------------ 
#
      PROC COMP_E4T  
#     ------------- 
#
# ------------------------------------------------------------------------------ 
#
# Form Taaaiii and form energy contribution 
# ----------------------------------------- 
#
# Set the numerical factor 
# ------------------------ 
#
            pcount = 0.0 
            fcount = 0.0 
            if whichi < whichj 
               pcount = pcount + 1 
            endif 
            if whichj < kstart  
               pcount = pcount + 1 
            endif 
            if a < a1 
               fcount = fcount + 1 
            endif 
            if a1 < a2 
               fcount = fcount + 1 
            endif 
            if pcount == 0.0
               if fcount == 0.0
                  efact = 1.0
                  fact = 1.0
               endif
            endif

            if pcount == 0.0
               if fcount == 1.0
                  efact = 3.0
                  fact = 3.0
               endif
            endif

            if pcount == 1.0
               if fcount == 0.0
                  efact = 3.0
                  fact = 3.0
               endif
            endif

            if pcount == 1.0
               if fcount == 1.0
                  efact = 9.0
                  fact = 3.0
               endif
            endif

            if pcount == 2.0
               if fcount == 0.0
                  efact = 6.0
                  fact = 6.0
               endif
            endif

            if pcount == 0.0
               if fcount == 2.0
                  efact = 6.0
                  fact = 6.0
               endif
            endif

            if pcount == 2.0
               if fcount == 1.0
                  efact = 18.0
                  fact = 12.0
               endif
            endif

            if pcount == 1.0
               if fcount == 2.0
                  efact = 18.0
                  fact = 12.0
               endif
            endif
            if pcount == 2.0
               if fcount == 2.0
                  efact = 36.0
                  fact = 18.0
               endif
            endif 
#
#   Compute the energy now 
#   ---------------------- 
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 

                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                        tpppp(a,a1,a2,k1)         = Raaaiii(a,a1,a2,k1,ii,jj)
                        t1pppp(a,a1,a2,k1)        = Xaaaiii(a,a1,a2,k1,ii,jj)
                        etemp                     = tpppp(a,a1,a2,k1)*t1pppp(a,a1,a2,k1) 
                        etemp                    *= efact 
                        esum                     += etemp 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC COMP_E4T  
#     ---------------- 
#
# ------------------------------------------------------------------------------ 
#
      PROC COMP_T3aaaiii   
#     ------------------ 
#
# ------------------------------------------------------------------------------ 
#
# Form Taaaiii and form energy contribution 
# ----------------------------------------- 
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 

                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                        taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                        execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        xaaaiii(a,a1,a2,k1,ii,jj) = taaaiii(a,a1,a2,k1,ii,jj) 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC COMP_T3aaaiii  
#     --------------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------ 
#
    PROC PSai_1  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               REQUEST               VSpipi(a1,j1,a2,k1) a1 
               t4pppp(a1,a2,k1,j1) = VSpipi(a1,j1,a2,k1) 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a1,a2,k1,jj) = 0.0
                        t2ppp(a1,a2,k1)     = 0.0
                        t3ppps(a1,a2,k1,ii) = 0.0
                        tps(a,ii)           = 0.0 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 4.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 2 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 4.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 3 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 4 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 4.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 5 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 6 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 7 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 4.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 8 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 9 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 10 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 11 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 12 OK  
#  ---------------------------------------------------------------------------------- 
                       if i1 == j1  
                       if j1 == k1  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 13 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 14 OK 
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           tps(a,ii)      *= 2.0 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 15 OK  
#  ---------------------------------------------------------------------------------- 
                       if i1 == j1  
                       if j1 == k1  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 16 OK 
#  ---------------------------------------------------------------------------------- 
                       if i1 == j1  
                       if j1 == k1  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_1 
                           PUT xai(a,ii)  += tps(a,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_1  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_2  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
               REQUEST VSpipi(a1,i1,a2,k1) a1 
               t4pppp(a1,a2,k1,i1) = VSpipi(a1,i1,a2,k1) 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a1,a2,k1,ii) = 0.0
                        t2ppp(a1,a2,k1)     = 0.0  
                        t3ppps(a1,a2,k1,jj) = 0.0  
                        tps(a,jj)           = 0.0  
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 4.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 3 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 4.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 4 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 4.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 5 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 2.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 9 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 4.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 10 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 2.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 11 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 2.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 13 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_2 
                           tps(a,jj)      *= 2.0  
                           PUT xai(a,jj)  += tps(a,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_2  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_3  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
                REQUEST VSpipi(a1,j1,a2,i1) a1 
                t4pppp(a1,a2,j1,i1) = VSpipi(a1,j1,a2,i1) 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a1,a2,j1,ii) = 0.0
                        t2ppp(a1,a2,j1)     = 0.0  
                        t2pps(a1,a2,jj)     = 0.0 
                        t2pp(a1,a2)         = 0.0  
                        tpp(a,k1)           = 0.0  
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                          #CALL Sai_3 
                          #CALL Sai_3 
                          #CALL Sai_3 
                           CALL Sai_3 
                                tpp(a,k1)      *= 4.0  
                                PUT Sai(a,k1)  += tpp(a,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 2 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 

                          #CALL Sai_3 
                           CALL Sai_3 
                                tpp(a,k1)      *= 2.0  
                                PUT Sai(a,k1)  += tpp(a,k1)  

#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 4 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 

                          #CALL Sai_3 
                          #CALL Sai_3 
                          #CALL Sai_3 
                           CALL Sai_3 
                                tpp(a,k1)      *= 4.0  
                                PUT Sai(a,k1)  += tpp(a,k1)  

#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 5 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 

                          #CALL Sai_3 
                           CALL Sai_3 
                                tpp(a,k1)      *= 2.0  
                                PUT Sai(a,k1)  += tpp(a,k1)  

#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 7 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 

                          #CALL Sai_3 
                           CALL Sai_3 
                                tpp(a,k1)      *= 2.0  
                                PUT Sai(a,k1)  += tpp(a,k1)  

#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 8 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 

                           CALL Sai_3 
                                PUT Sai(a,k1)  += tpp(a,k1)  

#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 11 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                          #CALL Sai_3 
                           CALL Sai_3 
                                tpp(a,k1)      *= 2.0  
                                PUT Sai(a,k1)  += tpp(a,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 14 OK 
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_3 
                                PUT Sai(a,k1)  += tpp(a,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_3  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_4  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               REQUEST VSpipi(a,j1,a2,k1) a 
               t4pppp(a,a2,k1,j1) = VSpipi(a,j1,a2,k1) 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a,a2,k1,jj) = 0.0
                        t2ppp(a,a2,k1)     = 0.0  
                        t3ppps(a,a2,k1,ii) = 0.0  
                        tps(a1,ii)         = 0.0 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 4.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 2 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 4.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 3 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 2.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 5 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 4.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 6 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 2.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 8 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 4.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 10 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 2.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 15 OK  
#  ---------------------------------------------------------------------------------- 
                       if i1 == j1  
                       if j1 == k1  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_4 
                           tps(a1,ii)      *= 2.0  
                           PUT xai(a1,ii)  += tps(a1,ii)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_4  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_5  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               REQUEST VSpipi(a1,j1,a,k1) a 
               t4pppp(a,a1,k1,j1) = VSpipi(a1,j1,a,k1) 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a,a1,k1,jj) = 0.0
                        t2ppp(a,a1,k1)     = 0.0  
                        t3ppps(a,a1,k1,ii) = 0.0  
                        tps(a2,ii)         = 0.0 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
                           CALL Sai_5 
                           tps(a2,ii)      *= 4.0  
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 2 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
                           CALL Sai_5 
                           tps(a2,ii)      *= 4.0  
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 3 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
                           CALL Sai_5 
                           tps(a2,ii)      *= 2.0  
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 4 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
                           CALL Sai_5 
                           tps(a2,ii)      *= 2.0  
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 6 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
                           CALL Sai_5 
                           tps(a2,ii)      *= 2.0  
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 7 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
                           CALL Sai_5 
                           tps(a2,ii)      *= 2.0  
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 9 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a == a1 
                       if a1 < a2 
                           CALL Sai_5 
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 12 OK  
#  ---------------------------------------------------------------------------------- 
                       if i1 == j1  
                       if j1 == k1  
                       if a == a1 
                       if a1 < a2 
                           CALL Sai_5 
                           PUT xai(a2,ii)  += tps(a2,ii)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_5  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_6  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
                  REQUEST VSpipi(a,i1,a2,k1) a 
                  t4pppp(a,a2,k1,i1) = VSpipi(a,i1,a2,k1) 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a,a2,k1,ii) = 0.0
                        t2ppp(a,a2,k1)     = 0.0  
                        t3ppps(a,a2,k1,jj) = 0.0  
                        tps(a1,jj)         = 0.0  
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_6 
                           tps(a1,jj)      *= 4.0 
                           PUT xai(a1,jj)  += tps(a1,jj)  
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 3 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_6 
                           tps(a1,jj)      *= 4.0 
                           PUT xai(a1,jj)  += tps(a1,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 5 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_6 
                           tps(a1,jj)      *= 4.0 
                           PUT xai(a1,jj)  += tps(a1,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 10 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_6 
                           tps(a1,jj)      *= 4.0 
                           PUT xai(a1,jj)  += tps(a1,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_6  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_7  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
                  REQUEST VSpipi(a,j1,a2,i1) a 
                  t4pppp(a,a2,j1,i1) = VSpipi(a,j1,a2,i1) 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a,a2,j1,ii) = 0.0 
                        t2ppp(a,a2,j1)     = 0.0  
                        t2pps(a,a2,jj)     = 0.0
                        t2pp(a,a2)         = 0.0  
                        tpp(a1,k1)         = 0.0  
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_7 
                           tpp(a1,k1)      *= 4.0 
                           PUT Sai(a1,k1)  += tpp(a1,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 2 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_7 
                           tpp(a1,k1)      *= 2.0 
                           PUT Sai(a1,k1)  += tpp(a1,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_7 
                           tpp(a1,k1)      *= 4.0 
                           PUT Sai(a1,k1)  += tpp(a1,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 8 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 == a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_7 
                           tpp(a1,k1)      *= 2.0 
                           PUT Sai(a1,k1)  += tpp(a1,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_7  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_8  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
                  REQUEST VSpipi(a1,i1,a,k1) a 
                  t4pppp(a,a1,k1,i1) = VSpipi(a1,i1,a,k1) 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a,a1,k1,ii) = 0.0
                        t2ppp(a,a1,k1)     = 0.0  
                        t3ppps(a,a1,k1,jj) = 0.0  
                        tps(a2,jj)         = 0.0  
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_8 
                           tps(a2,jj)      *= 4.0 
                           PUT xai(a2,jj)  += tps(a2,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 3 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_8 
                           tps(a2,jj)      *= 4.0 
                           PUT xai(a2,jj)  += tps(a2,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 4 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_8 
                           tps(a2,jj)      *= 2.0 
                           PUT xai(a2,jj)  += tps(a2,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 9 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj == kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_8 
                           tps(a2,jj)      *= 2.0 
                           PUT xai(a2,jj)  += tps(a2,jj)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_8  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
#
# ------------------------------------------------------------------------------------------------------- 
#
    PROC PSai_9  
#   -----------  
#
            kcount = 0.0 
            DO k1 
               kcount = kcount + 1 
               if kcount == kstart  
            jcount = 0.0 
            DO j1 
               jcount = jcount + 1 
               if jcount == whichj 
               icount = 0.0 
            DO i1 

               icount = icount + 1 
               if icount == whichi 
                  REQUEST VSpipi(a,i1,a1,j1) a 
                  t4pppp(a,a1,j1,i1) = VSpipi(a,i1,a1,j1) 
#
                  iicount = 0.0 
                  DO ii 
                     iicount = iicount + 1 
                     if iicount >= istart
                     if iicount <= iend
                        jjcount = 0.0 
                  DO jj 
                     jjcount = jjcount + 1 
                     if jjcount >= jstart
                     if jjcount <= jend
#
                       #taaaiii(a,a1,a2,k1,ii,jj) = xaaaiii(a,a1,a2,k1,ii,jj) 
                       #execute energy_tdenominator taaaiii(a,a1,a2,k1,ii,jj) 
                        tpppp(a,a1,a2,k1)         = xaaaiii(a,a1,a2,k1,ii,jj)
#
#  Zero some arrays so that they are freed at the end of the loop 
#  -------------------------------------------------------------- 
#
                        t2ppps(a,a1,j1,ii) = 0.0
                        t2ppp(a,a1,j1)     = 0.0  
                        t2pps(a,a1,jj)     = 0.0
                        t2pp(a,a1)         = 0.0  
                        tpp(a2,k1)         = 0.0  
#
#  ---------------------------------------------------------------------------------- 
#  Perm 1 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_9 
                           tpp(a2,k1)      *= 4.0 
                           PUT Sai(a2,k1)  += tpp(a2,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#  Perm 2 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a < a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_9 
                           tpp(a2,k1)      *= 2.0 
                           PUT Sai(a2,k1)  += tpp(a2,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 4 
#  ---------------------------------------------------------------------------------- 
                       if whichi < whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_9 
                           tpp(a2,k1)      *= 2.0 
                           PUT Sai(a2,k1)  += tpp(a2,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#  Perm 7 OK  
#  ---------------------------------------------------------------------------------- 
                       if whichi == whichj  
                       if whichj < kstart  
                       if a == a1 
                       if a1 < a2 
#  ---------------------------------------------------------------------------------- 
                           CALL Sai_9 
                           PUT Sai(a2,k1)  += tpp(a2,k1)  
#  ---------------------------------------------------------------------------------- 
                       endif 
                       endif 
                       endif 
                       endif 
#  ---------------------------------------------------------------------------------- 
#
#  ---------------------------------------------------------------------------------- 
#
                     endif 
                     endif 
                  ENDDO jj 
                     endif 
                     endif 
                  ENDDO ii 
#
               endif 
             ENDDO i1 
               endif 
             ENDDO j1 
               endif 
             ENDDO k1 
#
    ENDPROC PSai_9  
#   -------------- 
#
#  ---------------------------------------------------------------------------------- 
#
# ------------------------------------------------------------------------------ 
#
      PROC COMP_E5S   
#     ------------- 
#
# ------------------------------------------------------------------------------ 
#
# ------------------------------------------------------------------------------------------------------- 
#
#   Compute the sai so that the singles contribution to the energy can be computed  
#   ------------------------------------------------------------------------------  
#
    CALL PSai_1 
    CALL PSai_2 
    CALL PSai_3 
    CALL PSai_4 
    CALL PSai_5 
    CALL PSai_6 
    CALL PSai_7 
    CALL PSai_8 
    CALL PSai_9 
#
# ------------------------------------------------------------------------------ 
#
      ENDPROC COMP_E5S   
#     ------------------ 
#
# ------------------------------------------------------------------------------ 
#
# -----------------------------------------------------------------------------------  
#
      PROC OSEG_TRIP 
#     -------------- 
#
# Loop over the occupied combinations 
# ----------------------------------- 
#
      ncount = 0.0 
      DO NT 

         ncount = ncount + 1.0  
         execute print_scalar ncount 

         whichi = 1.0 
         execute get_ijk whichi ncount  

         istart = 2.0 
         execute get_ijk istart ncount  

         iend   = 3.0 
         execute get_ijk iend ncount  

         whichj = 4.0 
         execute get_ijk whichj ncount  

         jstart = 5.0 
         execute get_ijk jstart ncount  

         jend   = 6.0 
         execute get_ijk jend ncount  

         kstart = 7.0 
         execute get_ijk kstart ncount  
         kend = kstart 

         if kstart <= 0.0  
            exit 
         endif  

         if ncount >  0.0      
         if ncount <= xtemp1  
    
         IF whichj >= whichi 
         IF kstart >= whichj   
#
# ----------------------------------------------------------  
# Virtual symetry combination XX.  
# ----------------------------------------------------------  
#
# Set up the parallelization over the three virtual segments  
# ----------------------------------------------------------  
#
      PARDO a2, a1, a 
      where a  <= a1 
      where a1 <= a2 
#
# Allocate the partial amplitude array 
# ------------------------------------ 
#
            icount = 0 
            DO ii  
               icount = icount + 1 
               if icount >= istart 
               if icount <= iend  
               jcount = 0 
               DO jj 
                  jcount = jcount + 1 
                  if jcount >= jstart 
                  if jcount <= jend  
                  kcount = 0 
                  DO k1 
                     kcount = kcount + 1 
                     if kcount == kstart 
                        allocate Xaaaiii(a,a1,a2,k1,ii,jj) 
                        allocate Raaaiii(a,a1,a2,k1,ii,jj) 
                     endif 
                  ENDDO k1 
                  endif 
                  endif 
               ENDDO jj  
               endif 
               endif 
            ENDDO ii  
#
# First do the expensive part involving 3-virtual integrals and of order VVVVooo
# ------------------------------------------------------------------------------ 
      CALL V4O3_1 
      CALL V4O3_2 
      CALL V4O3_3 
      CALL V4O3_4 
      CALL V4O3_5 
      CALL V4O3_6 
      CALL V4O3_7 
      CALL V4O3_8 
      CALL V4O3_9 
#
# Second do the cheaper part involving 3-virtual integrals and of order VVVVooo
# ------------------------------------------------------------------------------ 
      CALL V3O4_1 
      CALL V3O4_2 
      CALL V3O4_3 
      CALL V3O4_4 
      CALL V3O4_5 
      CALL V3O4_6 
      CALL V3O4_7 
      CALL V3O4_8 
      CALL V3O4_9 
#
# Compute the 4th-order energy contribution 
# ----------------------------------------- 
      CALL COMP_T3aaaiii   
#
# Compute the 5th-order energy contribution 
# ----------------------------------------- 
      CALL COMP_E5S  

#  ---------------------------------------------------------------------------------- 
#  Put the right hand amplitude in Raaaiii 
#
      icount = 0
      DO ii
         icount = icount + 1
         if icount >= istart
         if icount <= iend
         jcount = 0
         DO jj
            jcount = jcount + 1
            if jcount >= jstart
            if jcount <= jend
            kcount = 0
            DO k1
               kcount = kcount + 1
               if kcount == kstart

                  Raaaiii(a,a1,a2,k1,ii,jj) = Xaaaiii(a,a1,a2,k1,ii,jj)
                  tpppp(a,a1,a2,k1)         = 0.0
                  Xaaaiii(a,a1,a2,k1,ii,jj) = tpppp(a,a1,a2,k1)
               endif
            ENDDO k1
            endif
            endif
         ENDDO jj
         endif
         endif
      ENDDO ii

# First do the expensive part involving 3-virtual integrals and of order VVVVooo
# ------------------------------------------------------------------------------ 
      CALL LV4O3_1
      CALL LV4O3_2
      CALL LV4O3_3
      CALL LV4O3_4
      CALL LV4O3_5
      CALL LV4O3_6
      CALL LV4O3_7
      CALL LV4O3_8
      CALL LV4O3_9
#
# Second do the cheaper part involving 3-virtual integrals and of order VVVVooo
# ------------------------------------------------------------------------------

      CALL LV3O4_1
      CALL LV3O4_2
      CALL LV3O4_3
      CALL LV3O4_4
      CALL LV3O4_5
      CALL LV3O4_6
      CALL LV3O4_7
      CALL LV3O4_8
      CALL LV3O4_9

      CALL COMP_E4T 
#
# deAllocate the partial amplitude array 
# -------------------------------------- 
#
            deallocate Xaaaiii(a,a1,a2,k1,ii,jj) 
            deallocate Raaaiii(a,a1,a2,k1,ii,jj) 
#
      ENDPARDO a2, a1, a 
      execute server_barrier 
#
      endif 
      endif 
      endif 
      endif 
      ENDDO NT 
#
# ----------------------------------------------------------  
# End Virtual symetry combination XX.  
# ----------------------------------------------------------  
#
      ENDPROC OSEG_TRIP 
#     ----------------- 
#
# -----------------------------------------------------------------------------------  


#-------------------------------------------------------------------------
#
#    -------------------
      PROC  GET_RL_AMPS
#    -------------------
#
#
      rootcount = 0

      DO indone
      DO kroot

         GET  REE (kroot,indone)
         tee (kroot,indone) = REE (kroot,indone)

         rootcount += 1
         IF rootcount == iroot
            EXECUTE  RETURN_SVAL  tee  OMEGA
         ENDIF

      ENDDO kroot
      ENDDO indone

      EXECUTE  SIP_BARRIER

      ncount    = 0
      rootcount = 0
      DO indone
      DO kroot

         GET                  LEE (kroot,indone)
         tee (kroot,indone) = LEE (kroot,indone)
         EXECUTE  RETURN_SVAL  tee  L_OMEGA
         etemp = L_OMEGA - OMEGA
         IF etemp < 0.0
            etemp *= -1.0
         ENDIF

         rootcount += 1
         IF etemp < root_thresh
            ncount = rootcount
            EXIT
         ENDIF

      ENDDO kroot
      ENDDO indone

      EXECUTE  SIP_BARRIER

#
#
#          ...Grab an R  array...
#                      k
#
#
      PARDO  a1, i1
         rootcount = 0
         DO kroot
            GET  R1A_VECS (a1,i1,kroot)
            rootcount += 1
            IF  rootcount == iroot
                tt1ai (a1,i1) = R1A_VECS (a1,i1,kroot)
                PREPARE  t1a_old (a1,i1) = tt1ai (a1,i1)
            ENDIF
         ENDDO kroot
      ENDPARDO  a1, i1

      PARDO  bb, jj1 
         rootcount = 0
         DO kroot
            GET  R1B_VECS (bb,jj1,kroot)
            rootcount += 1
            IF  rootcount == iroot
                tt1bj (bb,jj1) = R1B_VECS (bb,jj1,kroot)
                PREPARE  t1b_old (bb,jj1) = tt1bj (bb,jj1)
            ENDIF
         ENDDO kroot
      ENDPARDO  bb, jj1 

      PARDO  a1, i1, a2, i2
         rootcount = 0
         DO kroot
            REQUEST  R2AA_VECS (a1,i1,a2,i2,kroot) kroot
            rootcount += 1
            IF  rootcount == iroot
                tt1aiai (a1,i1,a2,i2) = R2AA_VECS (a1,i1,a2,i2,kroot)
                PREPARE  TSaiai (a1,i1,a2,i2) = tt1aiai (a1,i1,a2,i2)
            ENDIF
         ENDDO kroot
      ENDPARDO  a1, i1, a2, i2

      PARDO  bb, jj1, bb1, jj2 
         rootcount = 0
         DO kroot
            REQUEST  R2BB_VECS (bb,jj1,bb1,jj2,kroot) kroot
            rootcount += 1
            IF  rootcount == iroot
                tt1bjbj (bb,jj1,bb1,jj2) = R2BB_VECS (bb,jj1,bb1,jj2,kroot)
                PREPARE  TSbjbj (bb,jj1,bb1,jj2) = tt1bjbj (bb,jj1,bb1,jj2)
            ENDIF
         ENDDO kroot
      ENDPARDO  bb, jj1, bb1, jj2

      PARDO  a1, i1, bb, jj1
         rootcount = 0
         DO kroot
            REQUEST  R2AB_VECS (a1,i1,bb,jj1,kroot) kroot
            rootcount += 1
            IF  rootcount == iroot
                ttaibj (a1,i1,bb,jj1) = R2AB_VECS (a1,i1,bb,jj1,kroot)
                PREPARE  T2aibj (a1,i1,bb,jj1) = ttaibj (a1,i1,bb,jj1)
            ENDIF
         ENDDO kroot
      ENDPARDO  a1, i1, bb, jj1
#
#
#          ...Grab the corresponding L  array...
#                                     k
#
#
#
#
#          We found a matching excitation energy, so grab
#          the corresponding root!
#
#
      IF ncount > ZERO

         PARDO  a1, i1
            rootcount = 0
            DO kroot
               GET  L1A_VECS (i1,a1,kroot)
               rootcount += 1
               IF  rootcount == ncount
                   tt1ia (i1,a1) = L1A_VECS (i1,a1,kroot)
                   tt1ai (a1,i1) = tt1ia (i1,a1)
                   PREPARE  sl1a (a1,i1) = tt1ai (a1,i1)
                   EXIT
               ENDIF
            ENDDO kroot
         ENDPARDO  a1, i1

         PARDO  bb, jj1
            rootcount = 0
            DO kroot
               GET  L1B_VECS (jj1,bb,kroot)
               rootcount += 1
               IF  rootcount == ncount
                   tt1jb (jj1,bb) = L1B_VECS (jj1,bb,kroot)
                   tt1bj (bb,jj1) = tt1jb (jj1,bb)
                   PREPARE  sl1b (bb,jj1) = tt1bj (bb,jj1)
                   EXIT
               ENDIF
            ENDDO kroot
         ENDPARDO  bb, jj1

         PARDO  a1, i1, a2, i2
            rootcount = 0
            DO kroot
               REQUEST  L2AA_VECS (i1,a1,i2,a2,kroot) kroot
               rootcount += 1
               IF  rootcount == ncount
                   tt1iaia (i1,a1,i2,a2) = L2AA_VECS (i1,a1,i2,a2,kroot)
                   tt1aiai (a1,i1,a2,i2) = tt1iaia (i1,a1,i2,a2)
                   PREPARE  LSaiai (a1,i1,a2,i2) = tt1aiai (a1,i1,a2,i2)
               ENDIF
            ENDDO kroot
         ENDPARDO  a1, i1, a2, i2

         PARDO  bb, jj1, bb1, jj2
            rootcount = 0
            DO kroot
               REQUEST  L2BB_VECS (jj1,bb,jj2,bb1,kroot) kroot
               rootcount += 1
               IF  rootcount == ncount
                   tt1jbjb (jj1,bb,jj2,bb1) = L2BB_VECS (jj1,bb,jj2,bb1,kroot)
                   tt1bjbj (bb,jj1,bb1,jj2) = tt1jbjb (jj1,bb,jj2,bb1)
                   PREPARE  LSbjbj (bb,jj1,bb1,jj2) = tt1bjbj (bb,jj1,bb1,jj2)
               ENDIF
            ENDDO kroot
         ENDPARDO  bb, jj1, bb1, jj2

         PARDO  a1, i1, bb, jj1
            rootcount = 0
            DO kroot
               REQUEST  L2AB_VECS (i1,a1,jj1,bb,kroot) kroot
               rootcount += 1
               IF  rootcount == ncount
                  ttiajb (i1,a1,jj1,bb) = L2AB_VECS (i1,a1,jj1,bb,kroot)
                  ttaibj (a1,i1,bb,jj1) = ttiajb (i1,a1,jj1,bb)
                  PREPARE  L2aibj (a1,i1,bb,jj1) = ttaibj (a1,i1,bb,jj1)
               ENDIF
            ENDDO kroot
         ENDPARDO  a1, i1, bb, jj1

      ENDIF # ncount > 0
#
#
#          In the event that none of the L excitation energies
#          match the the current R excitation energy, we need
#          to put in R^t as L.
#
#
      IF ncount == ZERO

         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO
         EXECUTE  PRINT_SCALAR  ZERO

         PARDO  a1, i1
            rootcount = 0
            DO kroot
               GET  R1A_VECS (a1,i1,kroot)
               rootcount += 1
               IF  rootcount == iroot
                   tt1ai (a1,i1) = R1A_VECS (a1,i1,kroot)
                   PREPARE  sl1a (a1,i1) = tt1ai (a1,i1)
               ENDIF
            ENDDO kroot
         ENDPARDO  a1, i1

         PARDO  bb, jj1
            rootcount = 0
            DO kroot
               GET  R1B_VECS (bb,jj1,kroot)
               rootcount += 1
               IF  rootcount == iroot
                   tt1bj (bb,jj1) = R1B_VECS (bb,jj1,kroot)
                   PREPARE  sl1b (bb,jj1) = tt1bj (bb,jj1)
               ENDIF
            ENDDO kroot
         ENDPARDO  bb, jj1

         PARDO  a1, i1, a2, i2
            rootcount = 0
            DO kroot
               REQUEST  R2AA_VECS (a1,i1,a2,i2,kroot) kroot
               rootcount += 1
               IF  rootcount == iroot
                   tt1aiai (a1,i1,a2,i2) = R2AA_VECS (a1,i1,a2,i2,kroot)
                   PREPARE  LSaiai (a1,i1,a2,i2) = tt1aiai (a1,i1,a2,i2)
               ENDIF
            ENDDO kroot
         ENDPARDO  a1, i1, a2, i2

         PARDO  bb, jj1, bb1, jj2
            rootcount = 0
            DO kroot
               REQUEST  R2BB_VECS (bb,jj1,bb1,jj2,kroot) kroot
               rootcount += 1
               IF  rootcount == iroot
                   tt1bjbj (bb,jj1,bb1,jj2) = R2BB_VECS (bb,jj1,bb1,jj2,kroot)
                   PREPARE  LSbjbj (bb,jj1,bb1,jj2) = tt1bjbj (bb,jj1,bb1,jj2)
               ENDIF
            ENDDO kroot
         ENDPARDO  bb, jj1, bb1, jj2

         PARDO  a1, i1, bb, jj1
            rootcount = 0
            DO kroot
               REQUEST  R2AB_VECS (a1,i1,bb,jj1,kroot) kroot
               rootcount += 1
               IF  rootcount == iroot
                  ttaibj (a1,i1,bb,jj1) = R2AB_VECS (a1,i1,bb,jj1,kroot)
                  PREPARE  L2aibj (a1,i1,bb,jj1) = ttaibj (a1,i1,bb,jj1)
               ENDIF
            ENDDO kroot
         ENDPARDO  a1, i1, bb, jj1

      ENDIF

      EXECUTE  SERVER_BARRIER
#
      ENDPROC  GET_RL_AMPS
#-------------------------------------------------------------------------

#-------------------------------------------------------------------------
#
#    --------------------
      PROC  COMP_LR_NORM
#    --------------------
#
#
#    Compute R  due to the formula
#             0
#                 _               -1
#        R  = <0|(H R) |0> * omega
#         0           c
#
#-------------------------------------------------------------------------
#
#
#          ...Compute the contributions...
#
#
      R0 = 0.0

      etemp1 = 0.0
      etemp2 = 0.0
      etemp3 = 0.0
      etemp4 = 0.0
      etemp5 = 0.0
      sum1 = 0.0
      sum2 = 0.0
      sum3 = 0.0
      sum4 = 0.0
      sum5 = 0.0

      PARDO  a, i

         GET  HBAR_ia (i,a)
         GET  R1A_VECS (a,i,indstate)
         tai (a,i) = R1A_VECS (a,i,indstate) 
         etemp = HBAR_ia (i,a) * tai(a,i)
         sum1 += etemp

      ENDPARDO  a, i

      PARDO  bb, jj1

         GET  HBAR_jb (jj1,bb)
         GET  R1B_VECS (bb,jj1,indstate)
         tbj (bb,jj1) = R1B_VECS (bb,jj1,indstate)
         etemp = HBAR_jb (jj1,bb) * tbj(bb,jj1)
         sum2 += etemp

      ENDPARDO  bb, jj1

      PARDO  a, a1, i, i1

         REQUEST  R2AA_VECS  (a,i,a1,i1,indstate) i1
         REQUEST  VSpipi (a,i,a1,i1) i1
         tpppp(a,i,a1,i1) = R2AA_VECS  (a,i,a1,i1,indstate)
         etemp = tpppp (a,i,a1,i1) * VSpipi (a,i,a1,i1)
         sum3 += etemp

      ENDPARDO  a, a1, i, i1

      PARDO  bb, bb1, jj1, jj2

         REQUEST  R2BB_VECS  (bb,jj1,bb1,jj2,indstate) jj2
         REQUEST  VSqjqj (bb,jj1,bb1,jj2) jj2
         tbjbj(bb,jj1,bb1,jj2) = R2BB_VECS  (bb,jj1,bb1,jj2,indstate)
         etemp = tbjbj (bb,jj1,bb1,jj2) * VSqjqj (bb,jj1,bb1,jj2)
         sum4 += etemp

      ENDPARDO  bb, bb1, jj1, jj2

      PARDO  a, i, bb, jj1

         REQUEST  R2AB_VECS (a,i,bb,jj1,indstate) jj1
         REQUEST  Vpiqj (a,i,bb,jj1) jj1
         taibj(a,i,bb,jj1) = R2AB_VECS (a,i,bb,jj1,indstate)
         etemp = taibj (a,i,bb,jj1) * Vpiqj (a,i,bb,jj1)
         sum5 += etemp

      ENDPARDO  a, i, bb, jj1

      EXECUTE  SERVER_BARRIER

      collective  etemp1 += sum1
      collective  etemp2 += sum2
      collective  etemp3 += sum3
      collective  etemp4 += sum4
      collective  etemp5 += sum5

      etemp3 *= 0.25
      etemp4 *= 0.25

      R0 += etemp1
      R0 += etemp2
      R0 += etemp3
      R0 += etemp4
      R0 += etemp5

      EXECUTE  SIP_BARRIER

      R0      = R0 / OMEGA
      OMEGA2  = TWO / THREE
      OMEGA2 *= OMEGA

      EXECUTE  PRINT_SCALAR  R0
#
# Right Norm 
#
      RNORM  = R0
      RNORM *= R0
      esum   = 0.0

      PARDO  i, a

         GET         R1A_VECS (a,i,indstate)
         tai (a,i) = R1A_VECS (a,i,indstate)  
         etemp  = tai (a,i) * tai (a,i)
         esum  += etemp

      ENDPARDO  i, a

      PARDO  jj1, bb

         GET         R1B_VECS (bb,jj1,indstate)
         tbj (bb,jj1) = R1B_VECS (bb,jj1,indstate)
         etemp  = tbj (bb,jj1) * tbj (bb,jj1)
         esum  += etemp

      ENDPARDO  jj1, bb

      PARDO  a, i, a1, i1

         REQUEST             R2AA_VECS (a,i,a1,i1,indstate) i1
         taiai (a,i,a1,i1) = R2AA_VECS (a,i,a1,i1,indstate)  
         etemp  = taiai (a,i,a1,i1) * taiai (a,i,a1,i1)
         etemp  = etemp/4.0
         esum  += etemp

      ENDPARDO  a, i, a1, i1

      PARDO  bb, jj1, bb1, jj2

         REQUEST             R2BB_VECS (bb,jj1,bb1,jj2,indstate) jj2
         tbjbj (bb,jj1,bb1,jj2) = R2BB_VECS (bb,jj1,bb1,jj2,indstate)
         etemp  = tbjbj (bb,jj1,bb1,jj2) * tbjbj (bb,jj1,bb1,jj2)
         etemp  = etemp/4.0
         esum  += etemp

      ENDPARDO  bb, jj1, bb1, jj2

      PARDO  a, i, bb, jj1

         REQUEST           R2AB_VECS (a,i,bb,jj1,indstate) jj1
         taibj (a,i,bb,jj1) = R2AB_VECS (a,i,bb,jj1,indstate) 
         etemp  = taibj (a,i,bb,jj1) * taibj (a,i,bb,jj1)
         esum  += etemp

      ENDPARDO  a, i, bb, jj1

      EXECUTE  SIP_BARRIER
      EXECUTE  SERVER_BARRIER

      COLLECTIVE  RNORM += esum

      EXECUTE SIP_BARRIER
      EXECUTE  SQUARE_ROOT  RNORM  ONEHALF

      RNORM  = 1.0 / RNORM

#
#
# Leftp norm
#
      LNORM  = 0.0
      esum   = 0.0

      PARDO  i, a

         GET         R1A_VECS (a,i,indstate)
         REQUEST         sl1a (a,i) a
         tai (a,i) = R1A_VECS (a,i,indstate)
         etemp  = tai (a,i) * sl1a (a,i)
         esum  += etemp

      ENDPARDO  i, a

      PARDO  jj1, bb

         GET         R1B_VECS (bb,jj1,indstate)
         REQUEST         sl1b (bb,jj1) bb
         tbj (bb,jj1) = R1B_VECS (bb,jj1,indstate)
         etemp  = tbj (bb,jj1) * sl1b (bb,jj1)
         esum  += etemp

      ENDPARDO  jj1, bb

      PARDO  i, a, i1, a1

         REQUEST             R2AA_VECS (a,i,a1,i1,indstate) i1
         REQUEST             LSAiAi (a,i,a1,i1) a1
         taiai (a,i,a1,i1) = R2AA_VECS (a,i,a1,i1,indstate)
         etemp  = taiai (a,i,a1,i1) * LSaiai (a,i,a1,i1)
         etemp  = etemp/4.0
         esum  += etemp

      ENDPARDO  i, a, i1, a1

      PARDO  jj1, bb, jj2, bb1

         REQUEST             R2BB_VECS (bb,jj1,bb1,jj2,indstate) jj2
         REQUEST             LSbjbj (bb,jj1,bb1,jj2) bb1
         tbjbj (bb,jj1,bb1,jj2) = R2BB_VECS (bb,jj1,bb1,jj2,indstate)
         etemp  = tbjbj (bb,jj1,bb1,jj2) * LSbjbj (bb,jj1,bb1,jj2)
         etemp  = etemp/4.0
         esum  += etemp

      ENDPARDO  jj1, bb, jj2, bb1

      PARDO  a, i, bb, jj1

         REQUEST           R2AB_VECS (a,i,bb,jj1,indstate) jj1
         REQUEST           L2aibj (a,i,bb,jj1) jj1
         taibj (a,i,bb,jj1) = R2AB_VECS (a,i,bb,jj1,indstate)
         etemp  = taibj (a,i,bb,jj1) * L2aibj (a,i,bb,jj1)
         esum  += etemp

      ENDPARDO  a, i, bb, jj1

      EXECUTE  SIP_BARRIER
      EXECUTE  SERVER_BARRIER

      COLLECTIVE  LNORM += esum

      EXECUTE SIP_BARRIER

      execute print_scalar etemp

      LNORM *= RNORM
      etemp = LNORM
      LNORM = 1.0 / etemp
      LRNORM = LNORM * RNORM
#
      execute print_scalar R0
      execute print_scalar rnorm
      execute print_scalar lnorm
      execute print_scalar lrnorm
#

#
      ENDPROC  COMP_LR_NORM
#-------------------------------------------------------------------------



# ----------------------------------------------------------------------------------------- 
#
# BEGIN MAIN PROGRAM
# ------------------
#
      eaaa   = 0.0  
      esum   = 0.0  
      esum_S = 0.0  
      one = 1.0
      two = 2.0
      three = 3.0
      four  = 4.0
      five  = 5.0
      six   = 6.0
      seven = 7.0
      eight = 8.0
      nine  = 9.0
      ten   = 10.0
      eleven = 11.0
      twelve = 12.0
      thirteen = 13.0
      fourteen = 14.0
      fifteen = 15.0
      onehalf = 0.5

      root_thresh = eom_tol

      CREATE  REE
      CREATE  LEE
      CREATE  R1A_VECS
      CREATE  L1A_VECS
      CREATE  R1B_VECS
      CREATE  L1B_VECS
      CREATE  HBAR_ia
      CREATE  HBAR_jb

      create l1a_old 
      create l1b_old 
      execute sip_barrier 
#
# Read transformed integrals from lists
# -------------------------------------
#
      CALL READ_BLOCKDATA
      execute sip_barrier 
      CALL TRAN_UHF 
      execute server_barrier 
      destroy Vxaai

      iroot = 0
      DO indstate
         iroot += 1

         EXECUTE  PRINT_SCALAR  iroot
         eaaa   = 0.0
         esum   = 0.0
         esum_S = 0.0
         eSaaa  = 0.0

         create Sai 
         create Xai 
         CALL  GET_RL_AMPS

         IF OMEGA == 100000.0
             EXIT # Because we are all out of excitation energies!
         ENDIF

         CALL  COMP_LR_NORM

         EXECUTE  SIP_BARRIER

         esum   = 0.0
         eaaa   = 0.0
         esum_S = 0.0
         eSaaa  = 0.0
#
# Set the partitioning of the occupied segments 
# --------------------------------------------- 
         DO i1 
            execute set_ijk_aaa iflag(i1) 
         ENDDO i1 
         execute sip_barrier 
#
# Determine the total number of combinations 
# ------------------------------------------ 
#
         ncount = 0.0 
         DO NT 
            ncount = ncount + 1 
            kstart = 7.0 
            execute get_ijk kstart ncount  
   
            if kstart <= 0.0  
               ncount = ncount - 1 
               exit 
            endif  
         ENDDO NT 
# 
         TCOMB = ncount 
         execute print_scalar ncount 
#
# Determine the number of horizontal sections 
# ------------------------------------------- 
#
         xcount = 1.0 
        #execute pardo_sects xcount ncount   
        #nsects = ncount  
         nsects = 1.0   
#
         xtemp = TCOMB/nsects  
         execute print_scalar nsects 
         execute print_scalar xtemp  
#
# ----------------------------------------------------------  
# Compute occupied triplet combination.  
# ----------------------------------------------------------  

#
# ---------------------------- 
# Combination 1. 
# ---------------------------- 
      if nsects == one    
         xtemp1 = xtemp 
         CALL OSEG_TRIP 
      endif 
#
# ----------------------------------------------------------  
# End Virtual symetry combination 15.  
# ----------------------------------------------------------  
#
      execute print_scalar etemp 
      execute sip_barrier
      execute server_barrier
      execute print_scalar etemp 
#
# Compute the single contribution 
# ------------------------------- 
#
         PARDO a, i1 
               REQUEST   sl1a(a,i1) a  
               GET       Sai(a,i1) 
               etemp   = sl1a(a,i1)*Sai(a,i1)
               esum_s += etemp 
         ENDPARDO a, i1 
#
         PARDO a, ii 
               t1ps (a,ii) = 0.0
               PREQUEST  t1ps(a,ii) = sl1a(a,i1)   
               GET       Xai(a,ii) 
               etemp   = t1ps(a,ii)*Xai(a,ii)
               esum_s += etemp 
         ENDPARDO a, ii 
         execute sip_barrier
         execute server_barrier
        #execute print_scalar etemp  
#
         esum   = esum/36.0 
         esum_S = esum_S/4.0 
         execute sip_barrier
         collective eaaa  += esum 
         collective eSaaa += esum_s  
         execute sip_barrier
         execute print_scalar eaaa  
         execute print_scalar eSaaa  
    ###  eaaa *= 2.0 
    ###  eSaaa *= 2.0 
    ###  totenerg += eaaa 
    ###  totenerg += eSaaa 

         ecorrT  = eaaa
         ecorrT += eSaaa
         ecorrT *= LRNORM
         execute print_scalar ecorrT

         do kiter
            ncount1 = 0.0
            DO kptr1
               ncount1 = ncount1 + 1.0
               if ncount1 == one
                  tpinf(kiter,kptr1) = eSaaa
                  pinf(kiter,kptr1)  = tpinf(kiter,kptr1)
               endif
            ENDDO kptr1

            ncount1 = 0.0
            DO kptr1
               ncount1 = ncount1 + 1.0
               if ncount1 == two
                  tpinf(kiter,kptr1) = eaaa
                  pinf(kiter,kptr1)  = tpinf(kiter,kptr1)
               endif
            ENDDO kptr1

         enddo kiter

         etemp = 17.0
         execute print_rel_info etemp pinf
#
         execute sip_barrier
         rootcount = 0
         DO indone
         DO kroot
            rootcount += 1
            if rootcount == iroot
               tee  (kroot,indone) = OMEGA
               t1ee (kroot,indone) = ecorrT
               ST_ROOTS (kroot,indone) = tee  (kroot,indone)
               ST_ECORR (kroot,indone) = t1ee (kroot,indone)
               exit
            endif
         ENDDO kroot
         ENDDO indone

         EXECUTE  PRINT_SCALAR  OMEGA
         OMEGA += ecorrT
         EXECUTE  PRINT_SCALAR  OMEGA
         EXECUTE  PRINT_SCALAR  ZERO

         EXECUTE  SIP_BARRIER
         DELETE  Sai
         DELETE  Xai

      ENDDO indstate

     EXECUTE  EOMROOT_PRINT_NEW  ST_ROOTS  ST_ECORR

#
                           ENDSIAL CCSD_RHF_SV1
#
#
